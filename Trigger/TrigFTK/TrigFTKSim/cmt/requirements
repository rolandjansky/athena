################################################
package TrigFTKSim

author Guido Volpi <guido.volpi@cern.ch>

use AtlasPolicy AtlasPolicy-*
use GaudiInterface GaudiInterface-* External
use AtlasROOT		AtlasROOT-*		External
use AthenaBaseComps     AthenaBaseComps-*       Control
use HepPDT                     v*                         LCG_Interfaces
use StoreGate	StoreGate-*	Control
use PileUpTools	 	PileUpTools-*	Control
use InDetBeamSpotService       InDetBeamSpotService-*     InnerDetector/InDetConditions
use TrigFTKPool TrigFTKPool-* Trigger/TrigFTK
use PyJobTransforms PyJobTransforms-* Tools

use AtlasReconstructionRunTime AtlasReconstructionRunTime-*
use AtlasPolicy                AtlasPolicy-*
use GaudiInterface             GaudiInterface-*           External
use InDetIdentifier            InDetIdentifier-*          InnerDetector/InDetDetDescr
use InDetPrepRawData           InDetPrepRawData-*         InnerDetector/InDetRecEvent
use InDetReadoutGeometry       InDetReadoutGeometry-*     InnerDetector/InDetDetDescr
use StoreGate                  StoreGate-*                Control
use TrkParticleBase	       TrkParticleBase-*	  Tracking/TrkEvent

use TrkTruthData               TrkTruthData-*             Tracking/TrkEvent
use TrkTrackSummaryTool        TrkTrackSummaryTool-*      Tracking/TrkTools
use TrkToolInterfaces          TrkToolInterfaces-*        Tracking/TrkTools
use Particle                   Particle-*                 Reconstruction
use InDetConditionsSummaryService InDetConditionsSummaryService-* InnerDetector/InDetConditions
use TrigInDetEvent 	       TrigInDetEvent-*		  Trigger/TrigEvent
use AtlasBoost		       AtlasBoost-*		  External


use TrkTrack	TrkTrack-* Tracking/TrkEvent

private
use NavFourMom         NavFourMom-*            Event
#use TrkEventPrimitives	       TrkEventPrimitives-*	  Tracking/TrkEvent
use TrkMeasurementBase 		TrkMeasurementBase-* 		Tracking/TrkEvent
use TrkRIO_OnTrack		TrkRIO_OnTrack-*	Tracking/TrkEvent
use IdDictDetDescr             IdDictDetDescr-*           DetectorDescription
use AtlasHepMC                 AtlasHepMC-*               External
use EventInfo                  EventInfo-*                Event
use GeneratorObjects           GeneratorObjects-*         Generators
use InDetRawData               InDetRawData-*             InnerDetector/InDetRawEvent
use InDetSimData               InDetSimData-*             InnerDetector/InDetRawEvent

use TrigFTKToolInterfaces      TrigFTKToolInterfaces-*    Trigger/TrigTools

end_private

apply_tag  ROOTBasicLibs
apply_tag  ROOTMathLibs
apply_tag  ROOTSTLDictLibs
apply_tag  ROOTGraphicsLibs
apply_tag  ROOTTableLibs

## install librariesz`
#apply_pattern component_library

apply_pattern declare_joboptions files="-k=.*job[Oo]ptions.py *.py"
apply_pattern generic_declare_for_link kind=ftkmapfiles prefix=share/ftk_configuration/map_files files="../config/map_file/raw_7L.pmap ../config/map_file/raw_7L_unused.pmap ../config/map_file/raw_8Lc.pmap ../config/map_file/raw_8Lc_unused.pmap ../config/map_file/raw_11L.pmap ../config/map_file/raw_7L.rmap ../config/map_file/raw_11L.rmap   ../config/map_file/raw_11L.tmap  ../config/map_file/raw_8LcIbl123.pmap ../config/map_file/raw_12Libl.pmap ../config/map_file/raw_8LcIbl123_unused.pmap ../config/map_file/raw_12Libl.tmap"
apply_pattern generic_declare_for_link kind=ftkssdefs prefix=share/ftk_configuration/ss_files files="../config/ss_file/raw_24x20x36.ss ../config/ss_file/raw_48x40x36.ss ../config/ss_file/raw_unused.ss ../config/ss_file/raw_15x16x36.ss ../config/ss_file/raw_15x16x36unused.ss  ../config/ss_file/raw_30x32x36.ss ../config/ss_file/raw_30x32x72.ss ../config/ss_file/raw_50x64x14412LIblunused.ss ../config/ss_file/raw_50x64x14412LIbl.ss ../config/ss_file/raw_15x16x36Ibl.ss ../config/ss_file/raw_30x32x72Ibl.ss ../config/ss_file/raw_15x16x36Iblunused.ss ../config/ss_file/raw_8LcIBL123_unusedmedium.ss ../config/ss_file/raw_8LcIBL123_unusedsmall.ss ../config/ss_file/raw_8LcIBL123_i8s4_unused.ss ../config/ss_file/raw_60x32a64p2x72Ibl.ss"
apply_pattern generic_declare_for_link kind=ftkhwdef prefix=share/ftk_configuration/hwsdev_file files="../config/hwsdev_file/raw_7L.hw ../config/hwsdev_file/raw_11L.hw ../config/hwsdev_file/raw_8Lc.hw ../config/hwsdev_file/raw_8LcIbl123.hw ../config/hwsdev_file/raw_12L.hw"
apply_pattern generic_declare_for_link kind=ftkbadmod prefix=share/ftk_configuration/bad_modules files="../config/bad_modules/empty.bmap"

# Add transform
#private
apply_pattern declare_job_transforms tfs='*_tf.py' jo='skeleton.*.py'
apply_pattern generic_declare_for_link kind=json files="../share/$(package)Signatures.json" prefix=share/JobTransforms
#end_private


################################################
#Truth Algs
apply_pattern declare_python_modules files="__init__.py TrigFTKTruthAlgsConfig.py"

#################################################

apply_pattern dual_use_library files="FTKRoadFinderAlgo.cxx FTKDumpCondAlgo.cxx \
	RoadFinder.cxx FTK_SGHitInput.cxx \
	FTKDetectorTool.cxx FTK_SGRoadOutput.cxx FTK_SGTrackOutput.cxx \
	FTK_RoadMarketTool.cxx FTK_RoadMarketIO.cxx \
	FTK_RegionalRawInput.cxx \
	FTKSplitEncoder.cxx FTKSetup.cxx PatternBank.cxx \
	FTK_AMBank.cxx atlClustering.cxx FTKRoadFileOutput.cxx \
	FTKConstantBank.cxx FTKTrackInput.cxx FTKRoadFileInput.cxx \
	FTK_RawInput.cxx FTKTruthTrack.cxx FTKRawHit.cxx FTKDataInput.cxx \
	FTKPMap.cxx FTKRegionMap.cxx FTKSectorMap.cxx \
	FTKSSMap.cxx ftk_dcap.cxx \
	FTKRoad.cxx FTKHit.cxx FTKTrack.cxx \
	FTKRoadStream.cxx FTKRoadKDTree.cxx FTKTrackStream.cxx \
	FTKSS.cxx MultiTruth.cxx FTKPattern.cxx \
	tsp/*.cxx FTKMergerAlgo.cxx \
	TrackFitter.cxx TrackFitter711.cxx \
        FTKSector711DB.cxx \	
        FTKTrackFileOutput.cxx FTKTrackFitterAlgo.cxx  \
        FTKLogging.cxx FTKPatternOneSector.cxx FTKPatternBySector.cxx \
        FTKPatternWithCoverage.cxx FTKRootFile.cxx FTKMergeRoot.cxx \
     	$(bin)TrigFTKSimRootDict.cxx"


# the following two lines are required to enable the debug flags
#macro cppdebugflags '$(cppdebugflags_s)'
#macro_remove componentshr_linkopts "-Wl,-s"

private

macro_append Boost_linkopts "$(Boost_linkopts_iostreams) $(Boost_linkopts_program_options) $(Boost_linkopts_filesystem)  "
macro_append TrigFTKSim_pp_cppflags "-DHAVE_BOOST_IOSTREAMS "


action ftkstandalone_dict "( $(ROOTSYS)/bin/rootcint -f $(bin)TrigFTKSimRootDict.cxx -c -I../TrigFTKSim ../TrigFTKSim/FTKRoad.h ../TrigFTKSim/FTKTruthTrack.h ../TrigFTKSim/FTKRawHit.h ../TrigFTKSim/FTKHit.h ../TrigFTKSim/FTKTrack.h ../TrigFTKSim/FTKRoadStream.h ../TrigFTKSim/FTKTrackStream.h ../TrigFTKSim/FTKSS.h ../TrigFTKSim/MultiTruth.h ../TrigFTKSim/FTKPattern.h ../TrigFTKSim/TrigFTKSimLinkDef.h )"
macro_append all_dependencies " ftkstandalone_dict "
macro_append TrigFTKSim_dependencies " ftkstandalone_dict "
macro_append TrigFTKSimLib_dependencies " ftkstandalone_dict "

# Make trf prodsys signatures
action makeTrfSignatures "makeTrfSignatures.py --output ../share/$(package)Signatures.json"
macro_append makeTrfSignatures_dependencies " install_tfs_jop "
macro_append all_dependencies " makeTrfSignatures "
macro_append check_install_json_dependencies " makeTrfSignatures "
