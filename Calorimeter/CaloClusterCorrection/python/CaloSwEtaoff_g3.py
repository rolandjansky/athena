# Copyright (C) 2002-2020 CERN for the benefit of the ATLAS collaboration

#
# File: CaloClusterCorrection/python/CaloSwEtaoff_g3.py
# Created: Nov 2006, sss
# Purpose: Eta offset (s-shape) corrections, original G3 version.
#
# This is the original G3-based eta offset correction, translated from the
# original fortran version.
#


from CaloClusterCorrection.constants import \
     CALOCORR_EMB1, CALOCORR_EMB2, CALOCORR_EME1, CALOCORR_EME2, \
     EMB1, EME1, EMB2, EME2


#############################################################################
# barrel eta position (S-shape) correction for sampling 1
#
class CaloSwEtaoff_g3_b1_parms:
    region = CALOCORR_EMB1
    correction_coef = 0.001
    correction_degree = 2
    interp_degree = 1

    correction_bins = [
        0.14915, 0.35091, 0.54866, 0.70023, 0.95074, 1.15057
        ]

    correction = [
    [0.00060625,  0.46496,  0.43951,  0.44668,  0.46457,  0.44269,  0.45247],
    [0.00081875,  0.48602,  0.476,    0.4554,   0.4935,   0.47243,  0.4684 ],
    [0.00103125,  0.47323,  0.43763,  0.45227,  0.45387,  0.4561,   0.42372],
    [0.00124375,  0.35678,  0.33161,  0.3366,   0.3769,   0.36993,  0.36012],
    [0.00145625,  0.15322,  0.17447,  0.20115,  0.19289,  0.26117,  0.25023],
    [0.00166875, -0.1021,  -0.0798,  -0.00301,  0.02587,  0.08334,  0.10294],
    [0.00188125, -0.32048, -0.26631, -0.22049, -0.18293, -0.1057,  -0.06259],
    [0.00209375, -0.4314,  -0.39734, -0.3599,  -0.32175, -0.25388, -0.2258 ],
    [0.00230625, -0.48008, -0.46247, -0.43731, -0.39469, -0.30764, -0.32463],
    [0.00251875, -0.44999, -0.45039, -0.39664, -0.40431, -0.32203, -0.34574]
    ]


#############################################################################
# endcap eta position (S-shape) correction for sampling 1
#
class CaloSwEtaoff_g3_e1_parms:
    region = CALOCORR_EME1
    correction_coef = 0.001
    correction_degree = 3

    correction = [
        [ [0.00015, 0.03531],
          [0.00045, 0.17828],
          [0.00075, 0.33171],
          [0.00105, 0.55264],
          [0.00135, 0.56879],
          [0.00165, 0.65316],
          [0.00195, 0.59085],
          [0.00225, 0.33315],
          [0.00255, 0.09746],
          [0.00285, -0.16709],
          [0.00315, -0.51071],
          [0.00345, -0.79086],
          [0.00375, -1.0527],
          [0.00405, -1.1633],
          [0.00435, -1.2246],
          [0.00465, -1.1661],
          [0.00495, -1.0835],
          [0.00525, -0.93026],
          [0.00555, -0.63431],
          [0.00585, -0.42498] ],
    
        [ [0.0001, 0.0],
          [0.0003, 0.25306],
          [0.0005, 0.34187],
          [0.0007, 0.50228],
          [0.0009, 0.57427],
          [0.0011, 0.55935],
          [0.0013, 0.52874],
          [0.0015, 0.39925],
          [0.0017, 0.20678],
          [0.0019, -0.04625],
          [0.0021, -0.33231],
          [0.0023, -0.62167],
          [0.0025, -0.78044],
          [0.0027, -0.85615],
          [0.0029, -0.9053],
          [0.0031, -0.84229],
          [0.0033, -0.77421],
          [0.0035, -0.66805],
          [0.0037, -0.53387],
          [0.0039, 0.0] ],

        [ [7.5e-05, 0.26476],
          [0.000225, 0.35028],
          [0.000375, 0.46987],
          [0.000525, 0.51902],
          [0.000675, 0.56768],
          [0.000825, 0.55523],
          [0.000975, 0.53262],
          [0.001125, 0.43148],
          [0.001275, 0.27557],
          [0.001425, 0.12852],
          [0.001575, -0.11432],
          [0.001725, -0.24506],
          [0.001875, -0.39161],
          [0.002025, -0.44415],
          [0.002175, -0.48602],
          [0.002325, -0.50372],
          [0.002475, -0.50988],
          [0.002625, -0.32567],
          [0.002775, -0.20379],
          [0.002925, 0.0] ]
        ]


#############################################################################
# barrel eta position (S-shape) correction for sampling 2
#
class CaloSwEtaoff_g3_b2_parms:
    region = CALOCORR_EMB2
    correction_coef = 0.01
    residual_coef = 0.001
    correction_degree = 3
    residual_eval_degree = 1
    residual_degree = 2

    correction = [
        [0.0003125, 0.00637],
        [0.0009375, 0.04211],
        [0.0015625, 0.08828],
        [0.0021875, 0.11382],
        [0.0028125, 0.16287],
        [0.0034375, 0.20353],
        [0.0040625, 0.23561],
        [0.0046875, 0.27112],
        [0.0053125, 0.30883],
        [0.0059375, 0.34944],
        [0.0065625, 0.36506],
        [0.0071875, 0.38478],
        [0.0078125, 0.39651],
        [0.0084375, 0.39869],
        [0.0090625, 0.38781],
        [0.0096875, 0.35214],
        [0.0103125, 0.30744],
        [0.0109375, 0.23783],
        [0.0115625, 0.14325],
        [0.0121875, 0.03548],
        [0.0128125, -0.08761],
        [0.0134375, -0.19445],
        [0.0140625, -0.28279],
        [0.0146875, -0.34365],
        [0.0153125, -0.38791],
        [0.0159375, -0.41733],
        [0.0165625, -0.43066],
        [0.0171875, -0.42128],
        [0.0178125, -0.41288],
        [0.0184375, -0.39362],
        [0.0190625, -0.37207],
        [0.0196875, -0.34845],
        [0.0203125, -0.31187],
        [0.0209375, -0.274],
        [0.0215625, -0.23781],
        [0.0221875, -0.195],
        [0.0228125, -0.15279],
        [0.0234375, -0.10913],
        [0.0240625, -0.08176],
        [0.0246875, -0.04005] ]

    residuals = [
        [0.00125, 0.27067,  0.12679,  0.0027,  -0.09542, -0.06591, -0.34557],
        [0.00375, 0.27145,  0.16919,  0.07353,  0.00906, -0.1,     -0.29619],  
        [0.00625, 0.23725,  0.15188,  0.04369, -0.09484, -0.15978, -0.31441], 
        [0.00875, 0.28479,  0.20336,  0.08277, -0.00911, -0.05585, -0.35899], 
        [0.01125, 0.29884,  0.21377,  0.14735,  0.02146, -0.14185, -0.41464],  
        [0.01375, 0.09564,  0.07504, -0.05496, -0.15623, -0.07018, -0.13584], 
        [0.01625, 0.09158, -0.00519, -0.04834, -0.07372, -0.07021, -0.06172], 
        [0.01875, 0.12776,  0.10608, -0.01719, -0.10394, -0.10419, -0.21907], 
        [0.02125, 0.13389,  0.10165,  0.03954, -0.08366, -0.06337, -0.30239], 
        [0.02375, 0.11144,  0.04308,  0.03373,  0.07283, -0.17986, -0.3195] ]

    residual_bins = [
        0.14915, 0.35091, 0.54866, 0.70023, 0.95074, 1.15057
        ]



#############################################################################
# endcap eta position (S-shape) correction for sampling 2
#
class CaloSwEtaoff_g3_e2_parms:
    region = CALOCORR_EME2
    correction_degree = 3

    correction = [
        [0.0003125, 0.00046],
        [0.0009375, 0.0009],
        [0.0015625, 0.00153],
        [0.0021875, 0.00213],
        [0.0028125, 0.00253],
        [0.0034375, 0.00294],
        [0.0040625, 0.00322],
        [0.0046875, 0.0035],
        [0.0053125, 0.0037],
        [0.0059375, 0.0039],
        [0.0065625, 0.00404],
        [0.0071875, 0.00414],
        [0.0078125, 0.00411],
        [0.0084375, 0.00401],
        [0.0090625, 0.0038],
        [0.0096875, 0.00342],
        [0.0103125, 0.00294],
        [0.0109375, 0.00219],
        [0.0115625, 0.00141],
        [0.0121875, 0.00052],
        [0.0128125, -0.00038],
        [0.0134375, -0.00131],
        [0.0140625, -0.00198],
        [0.0146875, -0.00265],
        [0.0153125, -0.00316],
        [0.0159375, -0.00344],
        [0.0165625, -0.00366],
        [0.0171875, -0.00383],
        [0.0178125, -0.00369],
        [0.0184375, -0.00363],
        [0.0190625, -0.00352],
        [0.0196875, -0.00337],
        [0.0203125, -0.00311],
        [0.0209375, -0.00282],
        [0.0215625, -0.00242],
        [0.0221875, -0.00212],
        [0.0228125, -0.0017],
        [0.0234375, -0.00139],
        [0.0240625, -0.00095],
        [0.0246875, 7e-05] ]


CaloSwEtaoff_g3_parms = { EMB1 : CaloSwEtaoff_g3_b1_parms,
                          EMB2 : CaloSwEtaoff_g3_b2_parms,
                          EME1 : CaloSwEtaoff_g3_e1_parms,
                          EME2 : CaloSwEtaoff_g3_e2_parms,
                          }


