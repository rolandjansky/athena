# Copyright (C) 2002-2020 CERN for the benefit of the ATLAS collaboration

#
# File: CaloClusterCorrection/python/CaloSwEtaoff_v2.py
# Created: Nov 2006, sss
# Purpose: Eta offset (s-shape) corrections, v2.
#
# These corrections were derived using DC2 MC files reconstructed
# with 8.x.0.  Electrons at 50, 100, and 200 GeV were used.
# Derived for 5x5 clusters only.
#
# This was added in LArClusterRec-02-05-12, in 8.6.0.
#
# See CaloSwEtaoff_v2.h for more details.
#

from CaloClusterCorrection.constants import \
     CALOCORR_EMB1, CALOCORR_EMB2, CALOCORR_EME1, CALOCORR_EME2, \
     EMB1, EME1, EMB2, EME2
from AthenaCommon.SystemOfUnits import GeV


# Energies at which corrections were tabulated.
CaloSw_sample_energies = [50*GeV, 100*GeV, 200*GeV]


#############################################################################
# barrel eta position (S-shape) correction for sampling 1
#
class CaloSwEtaoff_v2_b1_parms:
    region = CALOCORR_EMB1
    degree = 3
    interp_barriers = []
    energies = CaloSw_sample_energies
    energy_degree = 2
    correction = [
        [
        [ 0.05,   5.454591e-04,   9.412656e-04,  -6.932359e-02],
        [ 0.15,   5.154604e-04,   1.021430e+00,  -1.038913e-01],
        [ 0.25,   5.201964e-04,   1.000751e+00,  -1.463504e-01],
        [ 0.35,   5.367553e-04,   9.424765e-01,  -1.771538e-01],
        [ 0.45,   5.149588e-04,   1.518958e+00,  -2.407728e-01],
        [ 0.55,   5.223967e-04,   1.284795e+00,  -2.695521e-01],
        [ 0.65,   5.488658e-04,   1.071486e+00,  -3.196700e-01],
        [ 0.75,   5.168200e-04,   1.094533e+00,  -2.543394e-01],
        [ 0.85,   5.431384e-04,   1.097851e+00,  -4.690285e-01],
        [ 0.95,   5.589233e-04,   9.742528e-01,  -4.332120e-01],
        [ 1.05,   6.014312e-04,   8.057341e-01,  -4.236833e-01],
        [ 1.15,   5.970610e-04,   1.366552e+00,  -4.220011e-01],
        [ 1.25,   6.223524e-04,   1.168266e+00,  -4.073313e-01],
        [ 1.35,   5.688281e-04,   1.832655e+00,  -4.255659e-01],
        ],

        [
        [ 0.05,   5.083151e-04,   1.640668e+00,  -5.804533e-02],
        [ 0.15,   5.250131e-04,   1.268519e+00,  -9.703922e-02],
        [ 0.25,   5.066508e-04,   1.345091e+00,  -1.571868e-01],
        [ 0.35,   5.144519e-04,   1.572102e+00,  -1.906901e-01],
        [ 0.45,   5.189295e-04,   1.397721e+00,  -2.227306e-01],
        [ 0.55,   5.266921e-04,   1.547540e+00,  -2.985803e-01],
        [ 0.65,   5.438521e-04,   1.421734e+00,  -3.139286e-01],
        [ 0.75,   5.373358e-04,   1.229688e+00,  -2.613686e-01],
        [ 0.85,   5.519268e-04,   1.298233e+00,  -4.484270e-01],
        [ 0.95,   5.692822e-04,   1.195497e+00,  -4.080466e-01],
        [ 1.05,   5.702371e-04,   1.462703e+00,  -4.030915e-01],
        [ 1.15,   5.856113e-04,   1.387561e+00,  -4.095322e-01],
        [ 1.25,   6.112790e-04,   1.115509e+00,  -4.288708e-01],
        [ 1.35,   6.161961e-04,   6.686042e-01,  -4.251241e-01],
        ],

        [
        [ 0.05,   5.125756e-04,   1.848390e+00,  -4.738372e-02],
        [ 0.15,   5.031207e-04,   1.898598e+00,  -1.133694e-01],
        [ 0.25,   5.146895e-04,   1.732243e+00,  -1.611869e-01],
        [ 0.35,   5.177613e-04,   1.676791e+00,  -1.958575e-01],
        [ 0.45,   5.258374e-04,   1.748278e+00,  -2.314694e-01],
        [ 0.55,   5.265504e-04,   1.880923e+00,  -2.894795e-01],
        [ 0.65,   5.424095e-04,   1.647257e+00,  -3.266239e-01],
        [ 0.75,   5.165737e-04,   1.158308e+00,  -2.407142e-01],
        [ 0.85,   5.578103e-04,   1.642801e+00,  -4.616890e-01],
        [ 0.95,   5.714202e-04,   1.366883e+00,  -4.388472e-01],
        [ 1.05,   5.797266e-04,   1.551921e+00,  -4.201731e-01],
        [ 1.15,   5.989632e-04,   1.310139e+00,  -4.215782e-01],
        [ 1.25,   6.058142e-04,   1.300679e+00,  -4.277517e-01],
        [ 1.35,   6.064828e-04,   1.261988e+00,  -4.324420e-01],
        ]
        ]


#############################################################################
# endcap eta position (S-shape) correction for sampling 1
#
class CaloSwEtaoff_v2_e1_parms:
    region = CALOCORR_EME1
    degree = 3
    interp_barriers = [2.0]
    energies = CaloSw_sample_energies
    energy_degree = 2
    correction = [
        [
        [ 1.55,   5.571851e-04,   1.180091e+00,  -7.831659e-01],
        [ 1.65,   6.525156e-04,   3.272428e-05,  -6.949906e-01],
        [ 1.75,   5.954208e-04,   7.036553e-01,  -8.167596e-01],
        [ 1.85,   7.294022e-04,   8.450469e-01,  -7.554451e-01],
        [ 1.95,   6.837084e-04,   9.214766e-01,  -8.183599e-01],
        [ 2.05,   9.041112e-04,   1.609473e+00,  -5.728347e-01],
        [ 2.15,   9.999849e-04,   1.196856e+00,  -5.247196e-01],
        [ 2.25,   1.029561e-03,   1.503502e+00,  -5.191914e-01],
        [ 2.35,   9.592339e-04,   1.353713e+00,  -3.796658e-01],
        ],

        [
        [ 1.55,   6.032297e-04,   2.985060e-01,  -7.248190e-01],
        [ 1.65,   6.058712e-04,   8.759009e-01,  -7.136404e-01],
        #[ 1.75,   4.966004e-04,   3.396819e+00,  -9.538800e-01],
        [ 1.85,   7.412910e-04,   1.055573e+00,  -7.117711e-01],
        [ 1.95,   7.582267e-04,   1.381727e+00,  -6.853114e-01],
        [ 2.05,   9.745148e-04,   1.974552e+00,  -4.367801e-01],
        [ 2.15,   1.084989e-03,   1.358115e+00,  -4.370167e-01],
        [ 2.25,   1.040369e-03,   2.005106e+00,  -4.639630e-01],
        [ 2.35,   1.038143e-03,   1.666166e+00,  -2.513799e-01],
        [ 999,    1.038143e-03,   1.666166e+00,  -2.513799e-01],
        ],

        [
        [ 1.55,   5.685995e-04,   1.668241e+00,  -7.303309e-01],
        [ 1.65,   6.132029e-04,   9.804429e-01,  -6.630564e-01],
        [ 1.75,   5.821848e-04,   1.405272e+00,  -7.850982e-01],
        [ 1.85,   7.437106e-04,   1.864164e+00,  -6.556725e-01],
        [ 1.95,   7.653646e-04,   1.832267e+00,  -5.709520e-01],
        [ 2.05,   9.933819e-04,   2.255502e+00,  -4.020914e-01],
        [ 2.15,   1.084884e-03,   1.923527e+00,  -3.953542e-01],
        [ 2.25,   1.096399e-03,   1.950219e+00,  -4.092030e-01],
        [ 2.35,   1.048980e-03,   1.851904e+00,  -2.403092e-01],
        ]
        ]


#############################################################################
# barrel eta position (S-shape) correction for sampling 2
#
class CaloSwEtaoff_v2_b2_parms:
    region = CALOCORR_EMB2
    degree = 3
    interp_barriers = [0.8]
    energies = CaloSw_sample_energies
    energy_degree = 2
    correction = [
        [
        [ 0.05,   3.503490e-03,   2.901405e+00,   4.839290e-03],
        [ 0.15,   3.516724e-03,   2.942001e+00,   1.446216e-02],
        [ 0.25,   3.505096e-03,   2.950688e+00,   2.981067e-02],
        [ 0.35,   3.506057e-03,   2.941437e+00,   4.752036e-02],
        [ 0.45,   3.500991e-03,   2.910294e+00,   7.630051e-02],
        [ 0.55,   3.494548e-03,   2.902326e+00,   9.869355e-02],
        [ 0.65,   3.384337e-03,   2.702028e+00,   1.814474e-01],
        [ 0.75,   3.140770e-03,   2.681672e+00,   3.120249e-01],
        [ 0.85,   3.357952e-03,   2.652087e+00,   7.732444e-02],
        [ 0.95,   3.166124e-03,   2.564356e+00,   2.773639e-01],
        [ 1.05,   3.038830e-03,   2.460855e+00,   4.116680e-01],
        [ 1.15,   2.899687e-03,   2.295528e+00,   5.554735e-01],
        [ 1.25,   2.856345e-03,   2.354065e+00,   6.470071e-01],
        [ 1.35,   2.797595e-03,   2.372002e+00,   7.424595e-01],
        ],

        [
        [ 0.05,   3.753791e-03,   3.081169e+00,  -1.171145e-02],
        [ 0.15,   3.714608e-03,   3.188118e+00,   5.329903e-03],
        [ 0.25,   3.660488e-03,   3.182998e+00,   1.015302e-02],
        [ 0.35,   3.679275e-03,   3.116574e+00,   2.173844e-02],
        [ 0.45,   3.702213e-03,   3.138002e+00,   4.252416e-02],
        [ 0.55,   3.671748e-03,   3.113081e+00,   4.745840e-02],
        [ 0.65,   3.593195e-03,   2.980820e+00,   1.269369e-01],
        [ 0.75,   3.422650e-03,   2.940236e+00,   2.206242e-01],
        [ 0.85,   3.608860e-03,   2.728802e+00,   2.380729e-02],
        [ 0.95,   3.374749e-03,   2.689585e+00,   1.837125e-01],
        [ 1.05,   3.272442e-03,   2.584887e+00,   2.980224e-01],
        [ 1.15,   3.165694e-03,   2.464632e+00,   3.957386e-01],
        [ 1.25,   3.093964e-03,   2.495809e+00,   4.656538e-01],
        [ 1.35,   3.091378e-03,   2.296467e+00,   5.458594e-01],
        ],

        [
        [ 0.05,   3.822734e-03,   3.491085e+00,  -1.118603e-03],
        [ 0.15,   3.811360e-03,   3.431343e+00,  -6.491349e-03],
        [ 0.25,   3.811308e-03,   3.443613e+00,  -2.772423e-03],
        [ 0.35,   3.830464e-03,   3.304869e+00,   6.697161e-04],
        [ 0.45,   3.810670e-03,   3.373219e+00,   1.788659e-02],
        [ 0.55,   3.817434e-03,   3.400790e+00,   2.317076e-02],
        [ 0.65,   3.736614e-03,   3.291341e+00,   6.612761e-02],
        [ 0.75,   3.636046e-03,   3.048799e+00,   1.489286e-01],
        [ 0.85,   3.699603e-03,   3.020125e+00,  -2.233352e-02],
        [ 0.95,   3.544020e-03,   2.883604e+00,   1.103127e-01],
        [ 1.05,   3.467178e-03,   2.818841e+00,   1.978377e-01],
        [ 1.15,   3.377931e-03,   2.669854e+00,   2.739294e-01],
        [ 1.25,   3.359356e-03,   2.630288e+00,   3.233065e-01],
        [ 1.35,   3.310702e-03,   2.648940e+00,   4.008334e-01],
        ]
        ]



#############################################################################
# endcap eta position (S-shape) correction for sampling 2
#
class CaloSwEtaoff_v2_e2_parms:
    region = CALOCORR_EME2
    degree = 3
    interp_barriers = []
    energies = CaloSw_sample_energies
    energy_degree = 2
    correction = [
        [
        [ 1.55,   2.941504e-03,   2.865237e+00,  -2.311939e-01],
        [ 1.65,   2.857560e-03,   2.553533e+00,  -1.991443e-01],
        [ 1.75,   2.955617e-03,   2.410890e+00,  -1.820337e-01],
        [ 1.85,   2.887389e-03,   2.226831e+00,  -1.694861e-01],
        [ 1.95,   2.886227e-03,   2.009839e+00,  -1.341893e-01],
        [ 2.05,   2.734360e-03,   1.928849e+00,  -1.210678e-01],
        [ 2.15,   2.564071e-03,   1.797230e+00,  -1.186894e-01],
        [ 2.25,   2.496026e-03,   1.623908e+00,  -1.841997e-01],
        [ 2.35,   2.599287e-03,   1.731524e+00,  -2.487003e-01],
        [ 2.45,   2.548716e-03,   1.305357e+00,  -5.889033e-02],
        ],

        [
        [ 1.55,   3.042533e-03,   2.614498e+00,  -2.250655e-01],
        [ 1.65,   3.167353e-03,   2.717027e+00,  -1.630610e-01],
        [ 1.75,   3.246760e-03,   2.505672e+00,  -1.038931e-01],
        [ 1.85,   3.146232e-03,   2.285496e+00,  -1.288077e-01],
        [ 1.95,   3.118400e-03,   2.078664e+00,  -9.112368e-02],
        [ 2.05,   2.965423e-03,   1.994242e+00,  -6.435410e-02],
        [ 2.15,   2.812551e-03,   1.750400e+00,  -7.766026e-02],
        [ 2.25,   2.752001e-03,   1.613092e+00,  -1.202919e-01],
        [ 2.35,   2.741286e-03,   1.751730e+00,  -1.656483e-01],
        [ 2.45,   2.788629e-03,   1.599908e+00,  -2.912829e-02],
        ],

        [
        [ 1.55,   3.321546e-03,   2.711019e+00,  -1.644987e-01],
        [ 1.65,   3.404484e-03,   2.625181e+00,  -1.072095e-01],
        [ 1.75,   3.429690e-03,   2.530732e+00,  -8.466756e-02],
        [ 1.85,   3.342363e-03,   2.430850e+00,  -8.104118e-02],
        [ 1.95,   3.275140e-03,   2.245379e+00,  -6.150019e-02],
        [ 2.05,   3.128531e-03,   2.010827e+00,  -3.988365e-02],
        [ 2.15,   2.990996e-03,   1.926793e+00,  -4.453879e-02],
        [ 2.25,   2.880576e-03,   1.840530e+00,  -8.212569e-02],
        [ 2.35,   2.940456e-03,   1.862974e+00,  -1.034889e-01],
        [ 2.45,   2.893755e-03,   1.703696e+00,  -1.083152e-02],
        ]
        ]


CaloSwEtaoff_v2_parms = { EMB1 : CaloSwEtaoff_v2_b1_parms,
                          EMB2 : CaloSwEtaoff_v2_b2_parms,
                          EME1 : CaloSwEtaoff_v2_e1_parms,
                          EME2 : CaloSwEtaoff_v2_e2_parms,
                          }
