# Copyright (C) 2002-2020 CERN for the benefit of the ATLAS collaboration

#
# File: CaloClusterCorrection/python/CaloSwPhioff_v3.py
# Created: Nov 2006, sss
# Purpose: Phi position corrections, v3.
#
# These corrections were derived using 11.0.41 simulation and 12.0
# reconstruction, for both electrons and photons, 5x5, 3x5, 3x7 clusters.
#
# This correction was in CaloClusterCorrection-00-02-58, in 12.0.3.
#

from CaloClusterCorrection.constants import \
     CALOCORR_EMB2, CALOCORR_EME2, EMB2, EME2
from AthenaCommon.SystemOfUnits import GeV


###############################################################################
# Tables for v3 phi offset correction, layer 2, 5x5 electron clusters
#


ele5_layer2_phioffv3_55_b = [
  [ 0.050000, 0.016752],
  [ 0.150000, 1.336188],
  [ 0.250000, -1.534780],
  [ 0.350000, 0.000000],
  [ 0.450000, 0.000000],
  [ 0.550000, 0.000000],
  [ 0.650000, 0.000000],
  [ 0.750000, 0.000000],
  [ 0.850000, 0.000000],
  [ 0.950000, 0.000000],
  [ 1.050000, 0.000000],
  [ 1.150000, 0.000000],
  [ 1.250000, 0.000000],
  [ 1.350000, 0.000000],
  [ 1.450000, 0.000000],
]
ele5_layer2_phioffv3_55_e = [
  [ 1.450000, 0.000000],
  [ 1.550000, 0.000000],
  [ 1.650000, 0.000000],
  [ 1.750000, 0.000000],
  [ 1.850000, 0.000000],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
ele10_layer2_phioffv3_55_b = [
  [ 0.050000, 0.687234],
  [ 0.150000, 0.678673],
  [ 0.250000, 1.013438],
  [ 0.350000, 1.082430],
  [ 0.450000, 0.994806],
  [ 0.550000, 1.410192],
  [ 0.650000, 1.210227],
  [ 0.750000, 2.009308],
  [ 0.850000, -0.605965],
  [ 0.950000, -1.232634],
  [ 1.050000, -1.574358],
  [ 1.150000, -0.900844],
  [ 1.250000, -1.186166],
  [ 1.350000, -2.261138],
  [ 1.450000, -0.399829],
]
ele10_layer2_phioffv3_55_e = [
  [ 1.450000, 2.481145],
  [ 1.550000, -0.701784],
  [ 1.650000, -0.630777],
  [ 1.750000, -1.464808],
  [ 1.850000, 2.802530],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
ele25_layer2_phioffv3_55_b = [
  [ 0.050000, 0.434041],
  [ 0.150000, 0.647221],
  [ 0.250000, 0.630306],
  [ 0.350000, 0.753114],
  [ 0.450000, 0.972087],
  [ 0.550000, 0.930267],
  [ 0.650000, 0.830688],
  [ 0.750000, 1.072143],
  [ 0.850000, -0.644146],
  [ 0.950000, -1.080481],
  [ 1.050000, -0.931203],
  [ 1.150000, -1.492595],
  [ 1.250000, -1.616259],
  [ 1.350000, -1.656212],
  [ 1.450000, -1.649346],
]
ele25_layer2_phioffv3_55_e = [
  [ 1.450000, 0.458953],
  [ 1.550000, -0.218459],
  [ 1.650000, -1.047975],
  [ 1.750000, -1.368569],
  [ 1.850000, -1.528893],
  [ 1.950000, -1.473807],
  [ 2.050000, -1.101740],
  [ 2.150000, -1.333711],
  [ 2.250000, -1.366975],
  [ 2.350000, 0.555138],
  [ 2.450000, 0.476548],
]
ele50_layer2_phioffv3_55_b = [
  [ 0.050000, 0.419032],
  [ 0.150000, 0.457276],
  [ 0.250000, 0.479138],
  [ 0.350000, 0.649491],
  [ 0.450000, 0.753401],
  [ 0.550000, 0.811220],
  [ 0.650000, 0.838323],
  [ 0.750000, 0.921419],
  [ 0.850000, -0.741123],
  [ 0.950000, -0.875549],
  [ 1.050000, -0.962659],
  [ 1.150000, -1.303134],
  [ 1.250000, -1.627288],
  [ 1.350000, -1.458731],
  [ 1.450000, -1.879304],
]
ele50_layer2_phioffv3_55_e = [
  [ 1.450000, -0.336658],
  [ 1.550000, -0.775464],
  [ 1.650000, -0.903116],
  [ 1.750000, -0.826994],
  [ 1.850000, -1.069809],
  [ 1.950000, -1.142309],
  [ 2.050000, -1.178417],
  [ 2.150000, -1.151508],
  [ 2.250000, -1.283708],
  [ 2.350000, 0.206568],
  [ 2.450000, 0.354603],
]
ele75_layer2_phioffv3_55_b = [
  [ 0.050000, 0.407890],
  [ 0.150000, 0.450110],
  [ 0.250000, 0.430019],
  [ 0.350000, 0.591703],
  [ 0.450000, 0.730558],
  [ 0.550000, 0.807936],
  [ 0.650000, 0.811532],
  [ 0.750000, 0.843528],
  [ 0.850000, -0.562257],
  [ 0.950000, -0.723809],
  [ 1.050000, -0.869968],
  [ 1.150000, -1.218063],
  [ 1.250000, -1.533754],
  [ 1.350000, -1.584706],
  [ 1.450000, -2.364106],
]
ele75_layer2_phioffv3_55_e = [
  [ 1.450000, -0.660369],
  [ 1.550000, -0.803708],
  [ 1.650000, -0.783809],
  [ 1.750000, -0.895125],
  [ 1.850000, -0.945488],
  [ 1.950000, -0.837282],
  [ 2.050000, -1.236767],
  [ 2.150000, -1.053872],
  [ 2.250000, -1.032106],
  [ 2.350000, 0.250276],
  [ 2.450000, 0.440946],
]
ele100_layer2_phioffv3_55_b = [
  [ 0.050000, 0.367984],
  [ 0.150000, 0.378674],
  [ 0.250000, 0.393380],
  [ 0.350000, 0.516192],
  [ 0.450000, 0.669056],
  [ 0.550000, 0.757689],
  [ 0.650000, 0.778472],
  [ 0.750000, 0.854538],
  [ 0.850000, -0.522826],
  [ 0.950000, -0.672968],
  [ 1.050000, -0.809899],
  [ 1.150000, -1.062162],
  [ 1.250000, -1.409708],
  [ 1.350000, -1.540736],
  [ 1.450000, -1.688011],
]
ele100_layer2_phioffv3_55_e = [
  [ 1.450000, -0.709795],
  [ 1.550000, -0.646031],
  [ 1.650000, -0.794432],
  [ 1.750000, -0.710567],
  [ 1.850000, -0.805088],
  [ 1.950000, -0.793226],
  [ 2.050000, -0.916056],
  [ 2.150000, -1.058245],
  [ 2.250000, -1.126769],
  [ 2.350000, 0.310291],
  [ 2.450000, 0.381127],
]
ele200_layer2_phioffv3_55_b = [
  [ 0.050000, 0.284383],
  [ 0.150000, 0.290651],
  [ 0.250000, 0.310941],
  [ 0.350000, 0.428557],
  [ 0.450000, 0.552541],
  [ 0.550000, 0.643016],
  [ 0.650000, 0.694281],
  [ 0.750000, 0.759994],
  [ 0.850000, -0.408948],
  [ 0.950000, -0.495206],
  [ 1.050000, -0.634682],
  [ 1.150000, -0.838315],
  [ 1.250000, -1.230027],
  [ 1.350000, -1.329166],
  [ 1.450000, -2.031922],
]
ele200_layer2_phioffv3_55_e = [
  [ 1.450000, -0.841292],
  [ 1.550000, -0.610854],
  [ 1.650000, -0.641901],
  [ 1.750000, -0.627728],
  [ 1.850000, -0.666729],
  [ 1.950000, -0.716908],
  [ 2.050000, -0.798899],
  [ 2.150000, -0.817652],
  [ 2.250000, -0.891972],
  [ 2.350000, 0.230120],
  [ 2.450000, 0.318983],
]
ele500_layer2_phioffv3_55_b = [
  [ 0.050000, 0.175198],
  [ 0.150000, 0.182876],
  [ 0.250000, 0.195556],
  [ 0.350000, 0.282385],
  [ 0.450000, 0.395807],
  [ 0.550000, 0.466732],
  [ 0.650000, 0.532817],
  [ 0.750000, 0.650580],
  [ 0.850000, -0.289588],
  [ 0.950000, -0.361195],
  [ 1.050000, -0.456898],
  [ 1.150000, -0.616542],
  [ 1.250000, -0.942893],
  [ 1.350000, -1.086167],
  [ 1.450000, -2.268907],
]
ele500_layer2_phioffv3_55_e = [
  [ 1.450000, -1.066074],
  [ 1.550000, -0.499036],
  [ 1.650000, -0.533124],
  [ 1.750000, -0.456314],
  [ 1.850000, -0.517348],
  [ 1.950000, -0.571733],
  [ 2.050000, -0.609696],
  [ 2.150000, -0.669358],
  [ 2.250000, -0.760843],
  [ 2.350000, 0.152118],
  [ 2.450000, 0.200941],
]
ele1000_layer2_phioffv3_55_b = [
  [ 0.050000, 0.097989],
  [ 0.150000, 0.098802],
  [ 0.250000, 0.115656],
  [ 0.350000, 0.178542],
  [ 0.450000, 0.284831],
  [ 0.550000, 0.365419],
  [ 0.650000, 0.421479],
  [ 0.750000, 0.528497],
  [ 0.850000, -0.220788],
  [ 0.950000, -0.278094],
  [ 1.050000, -0.360712],
  [ 1.150000, -0.487167],
  [ 1.250000, -0.767794],
  [ 1.350000, -0.928400],
  [ 1.450000, -2.735610],
]
ele1000_layer2_phioffv3_55_e = [
  [ 1.450000, -0.847353],
  [ 1.550000, -0.432166],
  [ 1.650000, -0.437081],
  [ 1.750000, -0.390685],
  [ 1.850000, -0.447176],
  [ 1.950000, -0.471801],
  [ 2.050000, -0.499554],
  [ 2.150000, -0.553751],
  [ 2.250000, -0.641628],
  [ 2.350000, 0.073040],
  [ 2.450000, 0.120639],
]


ele_layer2_phioffv3_55_b = [
    #ele5_layer2_phioffv3_55_b,
    ele10_layer2_phioffv3_55_b,
    ele25_layer2_phioffv3_55_b,
    ele50_layer2_phioffv3_55_b,
    ele75_layer2_phioffv3_55_b,
    ele100_layer2_phioffv3_55_b,
    ele200_layer2_phioffv3_55_b,
    ele500_layer2_phioffv3_55_b,
    ele1000_layer2_phioffv3_55_b,
    ]

ele_layer2_phioffv3_55_e = [
    #ele5_layer2_phioffv3_55_e,
    #ele10_layer2_phioffv3_55_e,
    ele25_layer2_phioffv3_55_e,
    ele50_layer2_phioffv3_55_e,
    ele75_layer2_phioffv3_55_e,
    ele100_layer2_phioffv3_55_e,
    ele200_layer2_phioffv3_55_e,
    ele500_layer2_phioffv3_55_e,
    ele1000_layer2_phioffv3_55_e,
    ]


###############################################################################
# Tables for v3 phi offset correction, layer 2, 5x5 photon clusters
#


gam5_layer2_phioffv3_55_b = [
  [ 0.050000, -0.213285],
  [ 0.150000, 0.858852],
  [ 0.250000, 1.002040],
  [ 0.350000, 0.469451],
  [ 0.450000, 1.168235],
  [ 0.550000, 0.816944],
  [ 0.650000, 0.271069],
  [ 0.750000, 1.331775],
  [ 0.850000, -0.950232],
  [ 0.950000, -1.258963],
  [ 1.050000, -1.319667],
  [ 1.150000, -1.500578],
  [ 1.250000, -2.199905],
  [ 1.350000, 0.000000],
  [ 1.450000, 0.000000],
]
gam5_layer2_phioffv3_55_e = [
  [ 1.450000, 0.000000],
  [ 1.550000, 0.000000],
  [ 1.650000, 0.000000],
  [ 1.750000, 0.000000],
  [ 1.850000, 0.000000],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
gam10_layer2_phioffv3_55_b = [
  [ 0.050000, 0.378878],
  [ 0.150000, 0.873200],
  [ 0.250000, 0.424885],
  [ 0.350000, 0.950598],
  [ 0.450000, 0.733111],
  [ 0.550000, 1.456254],
  [ 0.650000, 0.583902],
  [ 0.750000, 1.136113],
  [ 0.850000, -0.685087],
  [ 0.950000, -1.377749],
  [ 1.050000, -0.460363],
  [ 1.150000, -1.568566],
  [ 1.250000, -1.942817],
  [ 1.350000, -0.016655],
  [ 1.450000, -1.821695],
]
gam10_layer2_phioffv3_55_e = [
  [ 1.450000, 1.337736],
  [ 1.550000, -1.931133],
  [ 1.650000, -1.399962],
  [ 1.750000, -0.604819],
  [ 1.850000, -0.593833],
  [ 1.950000, -0.275314],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
gam25_layer2_phioffv3_55_b = [
  [ 0.050000, 0.502104],
  [ 0.150000, 0.319776],
  [ 0.250000, 0.631419],
  [ 0.350000, 0.767588],
  [ 0.450000, 0.777051],
  [ 0.550000, 0.633309],
  [ 0.650000, 0.662172],
  [ 0.750000, 0.904783],
  [ 0.850000, -0.809057],
  [ 0.950000, -0.898418],
  [ 1.050000, -1.495010],
  [ 1.150000, -1.609552],
  [ 1.250000, -1.793478],
  [ 1.350000, -1.510193],
  [ 1.450000, -1.564254],
]
gam25_layer2_phioffv3_55_e = [
  [ 1.450000, -0.288868],
  [ 1.550000, -0.696456],
  [ 1.650000, -0.954309],
  [ 1.750000, -0.929809],
  [ 1.850000, -1.966286],
  [ 1.950000, -0.908152],
  [ 2.050000, -1.162556],
  [ 2.150000, -1.196843],
  [ 2.250000, -1.334549],
  [ 2.350000, 0.496741],
  [ 2.450000, 0.230049],
]
gam50_layer2_phioffv3_55_b = [
  [ 0.050000, 0.353650],
  [ 0.150000, 0.327303],
  [ 0.250000, 0.372208],
  [ 0.350000, 0.484476],
  [ 0.450000, 0.684281],
  [ 0.550000, 0.726549],
  [ 0.650000, 0.796314],
  [ 0.750000, 0.864307],
  [ 0.850000, -0.523117],
  [ 0.950000, -0.683355],
  [ 1.050000, -0.833649],
  [ 1.150000, -1.119421],
  [ 1.250000, -1.480715],
  [ 1.350000, -1.400723],
  [ 1.450000, -1.893650],
]
gam50_layer2_phioffv3_55_e = [
  [ 1.450000, -0.628942],
  [ 1.550000, -0.666800],
  [ 1.650000, -0.843166],
  [ 1.750000, -1.002530],
  [ 1.850000, -0.983474],
  [ 1.950000, -1.098942],
  [ 2.050000, -0.997827],
  [ 2.150000, -1.100359],
  [ 2.250000, -1.105880],
  [ 2.350000, 0.265117],
  [ 2.450000, 0.342218],
]
gam75_layer2_phioffv3_55_b = [
  [ 0.050000, 0.311799],
  [ 0.150000, 0.340037],
  [ 0.250000, 0.380193],
  [ 0.350000, 0.451102],
  [ 0.450000, 0.560831],
  [ 0.550000, 0.691390],
  [ 0.650000, 0.730104],
  [ 0.750000, 0.838203],
  [ 0.850000, -0.457840],
  [ 0.950000, -0.577237],
  [ 1.050000, -0.732488],
  [ 1.150000, -0.856553],
  [ 1.250000, -1.324021],
  [ 1.350000, -1.446612],
  [ 1.450000, -2.294561],
]
gam75_layer2_phioffv3_55_e = [
  [ 1.450000, -0.804677],
  [ 1.550000, -0.624463],
  [ 1.650000, -0.767941],
  [ 1.750000, -0.611251],
  [ 1.850000, -0.790044],
  [ 1.950000, -0.821364],
  [ 2.050000, -0.878440],
  [ 2.150000, -1.024040],
  [ 2.250000, -1.047881],
  [ 2.350000, 0.215879],
  [ 2.450000, 0.209095],
]
gam100_layer2_phioffv3_55_b = [
  [ 0.050000, 0.274423],
  [ 0.150000, 0.291376],
  [ 0.250000, 0.303192],
  [ 0.350000, 0.407732],
  [ 0.450000, 0.539842],
  [ 0.550000, 0.599264],
  [ 0.650000, 0.684403],
  [ 0.750000, 0.743295],
  [ 0.850000, -0.425312],
  [ 0.950000, -0.520873],
  [ 1.050000, -0.639438],
  [ 1.150000, -0.858351],
  [ 1.250000, -1.226299],
  [ 1.350000, -1.382941],
  [ 1.450000, -1.988889],
]
gam100_layer2_phioffv3_55_e = [
  [ 1.450000, -0.984934],
  [ 1.550000, -0.639140],
  [ 1.650000, -0.681622],
  [ 1.750000, -0.660639],
  [ 1.850000, -0.720834],
  [ 1.950000, -0.768164],
  [ 2.050000, -0.815225],
  [ 2.150000, -0.891325],
  [ 2.250000, -0.970602],
  [ 2.350000, 0.217027],
  [ 2.450000, 0.297404],
]
gam200_layer2_phioffv3_55_b = [
  [ 0.050000, 0.197924],
  [ 0.150000, 0.204266],
  [ 0.250000, 0.219622],
  [ 0.350000, 0.313030],
  [ 0.450000, 0.437431],
  [ 0.550000, 0.508196],
  [ 0.650000, 0.561889],
  [ 0.750000, 0.672002],
  [ 0.850000, -0.317450],
  [ 0.950000, -0.404916],
  [ 1.050000, -0.503128],
  [ 1.150000, -0.682391],
  [ 1.250000, -1.025021],
  [ 1.350000, -1.156294],
  [ 1.450000, -1.851177],
]
gam200_layer2_phioffv3_55_e = [
  [ 1.450000, -1.048297],
  [ 1.550000, -0.502958],
  [ 1.650000, -0.570307],
  [ 1.750000, -0.490733],
  [ 1.850000, -0.553801],
  [ 1.950000, -0.603250],
  [ 2.050000, -0.646782],
  [ 2.150000, -0.737555],
  [ 2.250000, -0.805064],
  [ 2.350000, 0.155276],
  [ 2.450000, 0.209070],
]
gam500_layer2_phioffv3_55_b = [
  [ 0.050000, 0.103824],
  [ 0.150000, 0.107469],
  [ 0.250000, 0.107289],
  [ 0.350000, 0.188168],
  [ 0.450000, 0.298700],
  [ 0.550000, 0.376394],
  [ 0.650000, 0.411952],
  [ 0.750000, 0.525416],
  [ 0.850000, -0.214209],
  [ 0.950000, -0.282369],
  [ 1.050000, -0.335427],
  [ 1.150000, -0.491371],
  [ 1.250000, -0.784397],
  [ 1.350000, -0.899653],
  [ 1.450000, -2.022411],
]
gam500_layer2_phioffv3_55_e = [
  [ 1.450000, -1.251062],
  [ 1.550000, -0.437525],
  [ 1.650000, -0.461117],
  [ 1.750000, -0.384760],
  [ 1.850000, -0.435602],
  [ 1.950000, -0.495706],
  [ 2.050000, -0.508626],
  [ 2.150000, -0.545075],
  [ 2.250000, -0.645578],
  [ 2.350000, 0.078131],
  [ 2.450000, 0.111038],
]
gam1000_layer2_phioffv3_55_b = [
  [ 0.050000, 0.032045],
  [ 0.150000, 0.052615],
  [ 0.250000, 0.055024],
  [ 0.350000, 0.103377],
  [ 0.450000, 0.188315],
  [ 0.550000, 0.285422],
  [ 0.650000, 0.296366],
  [ 0.750000, 0.430385],
  [ 0.850000, -0.167377],
  [ 0.950000, -0.211505],
  [ 1.050000, -0.282994],
  [ 1.150000, -0.360382],
  [ 1.250000, -0.637029],
  [ 1.350000, -0.739141],
  [ 1.450000, -2.273007],
]
gam1000_layer2_phioffv3_55_e = [
  [ 1.450000, -0.916338],
  [ 1.550000, -0.363477],
  [ 1.650000, -0.352856],
  [ 1.750000, -0.319039],
  [ 1.850000, -0.381756],
  [ 1.950000, -0.408225],
  [ 2.050000, -0.414789],
  [ 2.150000, -0.441323],
  [ 2.250000, -0.542526],
  [ 2.350000, 0.001883],
  [ 2.450000, 0.071483],
]


gam_layer2_phioffv3_55_b = [
    #gam5_layer2_phioffv3_55_b,
    gam10_layer2_phioffv3_55_b,
    gam25_layer2_phioffv3_55_b,
    gam50_layer2_phioffv3_55_b,
    gam75_layer2_phioffv3_55_b,
    gam100_layer2_phioffv3_55_b,
    gam200_layer2_phioffv3_55_b,
    gam500_layer2_phioffv3_55_b,
    gam1000_layer2_phioffv3_55_b,
    ]

gam_layer2_phioffv3_55_e = [
    #gam5_layer2_phioffv3_55_e,
    #gam10_layer2_phioffv3_55_e,
    gam25_layer2_phioffv3_55_e,
    gam50_layer2_phioffv3_55_e,
    gam75_layer2_phioffv3_55_e,
    gam100_layer2_phioffv3_55_e,
    gam200_layer2_phioffv3_55_e,
    gam500_layer2_phioffv3_55_e,
    gam1000_layer2_phioffv3_55_e,
    ]


###############################################################################
# Tables for v3 phi offset correction, layer 2, 3x5 electron clusters
#


ele5_layer2_phioffv3_35_b = [
  [ 0.050000, -0.149310],
  [ 0.150000, 0.959078],
  [ 0.250000, -2.014405],
  [ 0.350000, 0.000000],
  [ 0.450000, 0.000000],
  [ 0.550000, 0.000000],
  [ 0.650000, 0.000000],
  [ 0.750000, 0.000000],
  [ 0.850000, 0.000000],
  [ 0.950000, 0.000000],
  [ 1.050000, 0.000000],
  [ 1.150000, 0.000000],
  [ 1.250000, 0.000000],
  [ 1.350000, 0.000000],
  [ 1.450000, 0.000000],
]
ele5_layer2_phioffv3_35_e = [
  [ 1.450000, 0.000000],
  [ 1.550000, 0.000000],
  [ 1.650000, 0.000000],
  [ 1.750000, 0.000000],
  [ 1.850000, 0.000000],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
ele10_layer2_phioffv3_35_b = [
  [ 0.050000, 0.743648],
  [ 0.150000, 0.746929],
  [ 0.250000, 1.045132],
  [ 0.350000, 1.178926],
  [ 0.450000, 0.999882],
  [ 0.550000, 1.379777],
  [ 0.650000, 1.344194],
  [ 0.750000, 1.904132],
  [ 0.850000, -0.604648],
  [ 0.950000, -1.151011],
  [ 1.050000, -1.594129],
  [ 1.150000, -1.044172],
  [ 1.250000, -1.182935],
  [ 1.350000, -2.122296],
  [ 1.450000, -0.963154],
]
ele10_layer2_phioffv3_35_e = [
  [ 1.450000, 10.037674],
  [ 1.550000, -0.980916],
  [ 1.650000, -0.475673],
  [ 1.750000, -1.330794],
  [ 1.850000, 3.105005],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
ele25_layer2_phioffv3_35_b = [
  [ 0.050000, 0.474437],
  [ 0.150000, 0.679352],
  [ 0.250000, 0.677515],
  [ 0.350000, 0.797769],
  [ 0.450000, 1.017529],
  [ 0.550000, 0.981659],
  [ 0.650000, 0.896651],
  [ 0.750000, 1.127484],
  [ 0.850000, -0.636644],
  [ 0.950000, -1.070452],
  [ 1.050000, -0.925840],
  [ 1.150000, -1.517505],
  [ 1.250000, -1.626144],
  [ 1.350000, -1.744607],
  [ 1.450000, -1.463405],
]
ele25_layer2_phioffv3_35_e = [
  [ 1.450000, 0.506299],
  [ 1.550000, -0.297643],
  [ 1.650000, -1.050265],
  [ 1.750000, -1.296551],
  [ 1.850000, -1.538824],
  [ 1.950000, -1.458780],
  [ 2.050000, -1.053348],
  [ 2.150000, -1.322942],
  [ 2.250000, -1.340655],
  [ 2.350000, 0.641176],
  [ 2.450000, 0.567363],
]
ele50_layer2_phioffv3_35_b = [
  [ 0.050000, 0.451341],
  [ 0.150000, 0.487292],
  [ 0.250000, 0.515960],
  [ 0.350000, 0.690169],
  [ 0.450000, 0.795803],
  [ 0.550000, 0.854718],
  [ 0.650000, 0.885047],
  [ 0.750000, 0.971591],
  [ 0.850000, -0.729287],
  [ 0.950000, -0.865457],
  [ 1.050000, -0.957546],
  [ 1.150000, -1.304573],
  [ 1.250000, -1.641814],
  [ 1.350000, -1.464296],
  [ 1.450000, -2.210506],
]
ele50_layer2_phioffv3_35_e = [
  [ 1.450000, -0.488198],
  [ 1.550000, -0.778000],
  [ 1.650000, -0.876304],
  [ 1.750000, -0.799789],
  [ 1.850000, -1.042537],
  [ 1.950000, -1.110192],
  [ 2.050000, -1.147195],
  [ 2.150000, -1.123307],
  [ 2.250000, -1.246148],
  [ 2.350000, 0.290680],
  [ 2.450000, 0.425306],
]
ele75_layer2_phioffv3_35_b = [
  [ 0.050000, 0.433349],
  [ 0.150000, 0.477671],
  [ 0.250000, 0.458533],
  [ 0.350000, 0.624442],
  [ 0.450000, 0.766868],
  [ 0.550000, 0.842395],
  [ 0.650000, 0.850388],
  [ 0.750000, 0.889806],
  [ 0.850000, -0.548688],
  [ 0.950000, -0.712239],
  [ 1.050000, -0.858443],
  [ 1.150000, -1.210258],
  [ 1.250000, -1.532163],
  [ 1.350000, -1.581123],
  [ 1.450000, -2.200593],
]
ele75_layer2_phioffv3_35_e = [
  [ 1.450000, -0.524189],
  [ 1.550000, -0.776093],
  [ 1.650000, -0.761828],
  [ 1.750000, -0.867485],
  [ 1.850000, -0.912494],
  [ 1.950000, -0.804233],
  [ 2.050000, -1.196729],
  [ 2.150000, -1.016107],
  [ 2.250000, -0.990518],
  [ 2.350000, 0.328561],
  [ 2.450000, 0.503390],
]
ele100_layer2_phioffv3_35_b = [
  [ 0.050000, 0.393388],
  [ 0.150000, 0.402639],
  [ 0.250000, 0.419108],
  [ 0.350000, 0.545814],
  [ 0.450000, 0.697890],
  [ 0.550000, 0.788891],
  [ 0.650000, 0.811519],
  [ 0.750000, 0.904380],
  [ 0.850000, -0.506506],
  [ 0.950000, -0.660972],
  [ 1.050000, -0.797869],
  [ 1.150000, -1.053272],
  [ 1.250000, -1.410818],
  [ 1.350000, -1.537366],
  [ 1.450000, -2.198289],
]
ele100_layer2_phioffv3_35_e = [
  [ 1.450000, -0.666716],
  [ 1.550000, -0.631220],
  [ 1.650000, -0.773327],
  [ 1.750000, -0.683432],
  [ 1.850000, -0.777350],
  [ 1.950000, -0.760118],
  [ 2.050000, -0.883272],
  [ 2.150000, -1.025714],
  [ 2.250000, -1.086526],
  [ 2.350000, 0.377245],
  [ 2.450000, 0.434336],
]
ele200_layer2_phioffv3_35_b = [
  [ 0.050000, 0.300751],
  [ 0.150000, 0.307455],
  [ 0.250000, 0.327300],
  [ 0.350000, 0.449438],
  [ 0.450000, 0.575798],
  [ 0.550000, 0.667610],
  [ 0.650000, 0.721079],
  [ 0.750000, 0.797775],
  [ 0.850000, -0.397489],
  [ 0.950000, -0.485642],
  [ 1.050000, -0.623626],
  [ 1.150000, -0.827795],
  [ 1.250000, -1.222051],
  [ 1.350000, -1.316909],
  [ 1.450000, -2.282825],
]
ele200_layer2_phioffv3_35_e = [
  [ 1.450000, -0.685692],
  [ 1.550000, -0.581763],
  [ 1.650000, -0.621407],
  [ 1.750000, -0.606495],
  [ 1.850000, -0.642779],
  [ 1.950000, -0.689209],
  [ 2.050000, -0.764619],
  [ 2.150000, -0.780819],
  [ 2.250000, -0.858833],
  [ 2.350000, 0.288957],
  [ 2.450000, 0.360902],
]
ele500_layer2_phioffv3_35_b = [
  [ 0.050000, 0.189727],
  [ 0.150000, 0.198209],
  [ 0.250000, 0.211301],
  [ 0.350000, 0.299662],
  [ 0.450000, 0.415831],
  [ 0.550000, 0.485813],
  [ 0.650000, 0.554172],
  [ 0.750000, 0.676583],
  [ 0.850000, -0.274796],
  [ 0.950000, -0.349080],
  [ 1.050000, -0.445311],
  [ 1.150000, -0.607757],
  [ 1.250000, -0.937219],
  [ 1.350000, -1.081193],
  [ 1.450000, -2.179391],
]
ele500_layer2_phioffv3_35_e = [
  [ 1.450000, -0.872882],
  [ 1.550000, -0.480366],
  [ 1.650000, -0.513717],
  [ 1.750000, -0.434327],
  [ 1.850000, -0.492367],
  [ 1.950000, -0.542559],
  [ 2.050000, -0.578297],
  [ 2.150000, -0.636955],
  [ 2.250000, -0.726531],
  [ 2.350000, 0.201803],
  [ 2.450000, 0.241994],
]
ele1000_layer2_phioffv3_35_b = [
  [ 0.050000, 0.111883],
  [ 0.150000, 0.112598],
  [ 0.250000, 0.130531],
  [ 0.350000, 0.195332],
  [ 0.450000, 0.301914],
  [ 0.550000, 0.383437],
  [ 0.650000, 0.440487],
  [ 0.750000, 0.551930],
  [ 0.850000, -0.205252],
  [ 0.950000, -0.263561],
  [ 1.050000, -0.346338],
  [ 1.150000, -0.475303],
  [ 1.250000, -0.759217],
  [ 1.350000, -0.918224],
  [ 1.450000, -2.284204],
]
ele1000_layer2_phioffv3_35_e = [
  [ 1.450000, -0.827625],
  [ 1.550000, -0.412324],
  [ 1.650000, -0.418595],
  [ 1.750000, -0.367354],
  [ 1.850000, -0.421536],
  [ 1.950000, -0.443221],
  [ 2.050000, -0.469985],
  [ 2.150000, -0.521623],
  [ 2.250000, -0.607790],
  [ 2.350000, 0.117891],
  [ 2.450000, 0.157062],
]


ele_layer2_phioffv3_35_b = [
    #ele5_layer2_phioffv3_35_b,
    ele10_layer2_phioffv3_35_b,
    ele25_layer2_phioffv3_35_b,
    ele50_layer2_phioffv3_35_b,
    ele75_layer2_phioffv3_35_b,
    ele100_layer2_phioffv3_35_b,
    ele200_layer2_phioffv3_35_b,
    ele500_layer2_phioffv3_35_b,
    ele1000_layer2_phioffv3_35_b,
    ]

ele_layer2_phioffv3_35_e = [
    #ele5_layer2_phioffv3_35_e,
    #ele10_layer2_phioffv3_35_e,
    ele25_layer2_phioffv3_35_e,
    ele50_layer2_phioffv3_35_e,
    ele75_layer2_phioffv3_35_e,
    ele100_layer2_phioffv3_35_e,
    ele200_layer2_phioffv3_35_e,
    ele500_layer2_phioffv3_35_e,
    ele1000_layer2_phioffv3_35_e,
    ]


###############################################################################
# Tables for v3 phi offset correction, layer 2, 3x5 photon clusters
#


gam5_layer2_phioffv3_35_b = [
  [ 0.050000, -0.086445],
  [ 0.150000, 0.955823],
  [ 0.250000, 0.887365],
  [ 0.350000, 0.710282],
  [ 0.450000, 1.335527],
  [ 0.550000, 1.077576],
  [ 0.650000, 0.125773],
  [ 0.750000, 1.284458],
  [ 0.850000, -1.044747],
  [ 0.950000, -1.223506],
  [ 1.050000, -1.417580],
  [ 1.150000, -1.342242],
  [ 1.250000, -3.234913],
  [ 1.350000, 0.000000],
  [ 1.450000, 0.000000],
]
gam5_layer2_phioffv3_35_e = [
  [ 1.450000, 0.000000],
  [ 1.550000, 0.000000],
  [ 1.650000, 0.000000],
  [ 1.750000, 0.000000],
  [ 1.850000, 0.000000],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
gam10_layer2_phioffv3_35_b = [
  [ 0.050000, 0.415868],
  [ 0.150000, 0.916972],
  [ 0.250000, 0.497877],
  [ 0.350000, 0.920666],
  [ 0.450000, 0.821507],
  [ 0.550000, 1.557788],
  [ 0.650000, 0.619134],
  [ 0.750000, 1.179040],
  [ 0.850000, -0.591827],
  [ 0.950000, -1.342487],
  [ 1.050000, -0.656437],
  [ 1.150000, -1.422989],
  [ 1.250000, -2.020782],
  [ 1.350000, -0.106280],
  [ 1.450000, -1.604486],
]
gam10_layer2_phioffv3_35_e = [
  [ 1.450000, 2.466361],
  [ 1.550000, -1.743415],
  [ 1.650000, -1.287895],
  [ 1.750000, -0.641940],
  [ 1.850000, -0.532221],
  [ 1.950000, -0.111878],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
gam25_layer2_phioffv3_35_b = [
  [ 0.050000, 0.517183],
  [ 0.150000, 0.367265],
  [ 0.250000, 0.667582],
  [ 0.350000, 0.794076],
  [ 0.450000, 0.830875],
  [ 0.550000, 0.677072],
  [ 0.650000, 0.691464],
  [ 0.750000, 0.972817],
  [ 0.850000, -0.797025],
  [ 0.950000, -0.888924],
  [ 1.050000, -1.486336],
  [ 1.150000, -1.608522],
  [ 1.250000, -1.779252],
  [ 1.350000, -1.569017],
  [ 1.450000, -1.823246],
]
gam25_layer2_phioffv3_35_e = [
  [ 1.450000, -0.166397],
  [ 1.550000, -0.620876],
  [ 1.650000, -0.940348],
  [ 1.750000, -0.909458],
  [ 1.850000, -1.921789],
  [ 1.950000, -0.854339],
  [ 2.050000, -1.145658],
  [ 2.150000, -1.147563],
  [ 2.250000, -1.312573],
  [ 2.350000, 0.561292],
  [ 2.450000, 0.301079],
]
gam50_layer2_phioffv3_35_b = [
  [ 0.050000, 0.381239],
  [ 0.150000, 0.355563],
  [ 0.250000, 0.401504],
  [ 0.350000, 0.517028],
  [ 0.450000, 0.716954],
  [ 0.550000, 0.760776],
  [ 0.650000, 0.836121],
  [ 0.750000, 0.907447],
  [ 0.850000, -0.509236],
  [ 0.950000, -0.675394],
  [ 1.050000, -0.821431],
  [ 1.150000, -1.125163],
  [ 1.250000, -1.487501],
  [ 1.350000, -1.404865],
  [ 1.450000, -2.214152],
]
gam50_layer2_phioffv3_35_e = [
  [ 1.450000, -0.689511],
  [ 1.550000, -0.648545],
  [ 1.650000, -0.817775],
  [ 1.750000, -0.976819],
  [ 1.850000, -0.961567],
  [ 1.950000, -1.071680],
  [ 2.050000, -0.971500],
  [ 2.150000, -1.071001],
  [ 2.250000, -1.081721],
  [ 2.350000, 0.340463],
  [ 2.450000, 0.401504],
]
gam75_layer2_phioffv3_35_b = [
  [ 0.050000, 0.340128],
  [ 0.150000, 0.359065],
  [ 0.250000, 0.402020],
  [ 0.350000, 0.475870],
  [ 0.450000, 0.590495],
  [ 0.550000, 0.724205],
  [ 0.650000, 0.761074],
  [ 0.750000, 0.878261],
  [ 0.850000, -0.436874],
  [ 0.950000, -0.558815],
  [ 1.050000, -0.728667],
  [ 1.150000, -0.853037],
  [ 1.250000, -1.327621],
  [ 1.350000, -1.449319],
  [ 1.450000, -2.411982],
]
gam75_layer2_phioffv3_35_e = [
  [ 1.450000, -0.778038],
  [ 1.550000, -0.596811],
  [ 1.650000, -0.752096],
  [ 1.750000, -0.579581],
  [ 1.850000, -0.768119],
  [ 1.950000, -0.793624],
  [ 2.050000, -0.846631],
  [ 2.150000, -0.992386],
  [ 2.250000, -1.016382],
  [ 2.350000, 0.280882],
  [ 2.450000, 0.265823],
]
gam100_layer2_phioffv3_35_b = [
  [ 0.050000, 0.291450],
  [ 0.150000, 0.314744],
  [ 0.250000, 0.324546],
  [ 0.350000, 0.432190],
  [ 0.450000, 0.566106],
  [ 0.550000, 0.628651],
  [ 0.650000, 0.714751],
  [ 0.750000, 0.782275],
  [ 0.850000, -0.411847],
  [ 0.950000, -0.509278],
  [ 1.050000, -0.626776],
  [ 1.150000, -0.849905],
  [ 1.250000, -1.226142],
  [ 1.350000, -1.380118],
  [ 1.450000, -2.153632],
]
gam100_layer2_phioffv3_35_e = [
  [ 1.450000, -0.900540],
  [ 1.550000, -0.616339],
  [ 1.650000, -0.660333],
  [ 1.750000, -0.640099],
  [ 1.850000, -0.693678],
  [ 1.950000, -0.740654],
  [ 2.050000, -0.784114],
  [ 2.150000, -0.859454],
  [ 2.250000, -0.937544],
  [ 2.350000, 0.276693],
  [ 2.450000, 0.347988],
]
gam200_layer2_phioffv3_35_b = [
  [ 0.050000, 0.215536],
  [ 0.150000, 0.221270],
  [ 0.250000, 0.238763],
  [ 0.350000, 0.332585],
  [ 0.450000, 0.458465],
  [ 0.550000, 0.530904],
  [ 0.650000, 0.585598],
  [ 0.750000, 0.704261],
  [ 0.850000, -0.304903],
  [ 0.950000, -0.392663],
  [ 1.050000, -0.490428],
  [ 1.150000, -0.672100],
  [ 1.250000, -1.020395],
  [ 1.350000, -1.153653],
  [ 1.450000, -2.173031],
]
gam200_layer2_phioffv3_35_e = [
  [ 1.450000, -0.813797],
  [ 1.550000, -0.484682],
  [ 1.650000, -0.550874],
  [ 1.750000, -0.467883],
  [ 1.850000, -0.526386],
  [ 1.950000, -0.574855],
  [ 2.050000, -0.614553],
  [ 2.150000, -0.705338],
  [ 2.250000, -0.772945],
  [ 2.350000, 0.209906],
  [ 2.450000, 0.253958],
]
gam500_layer2_phioffv3_35_b = [
  [ 0.050000, 0.118172],
  [ 0.150000, 0.122161],
  [ 0.250000, 0.123254],
  [ 0.350000, 0.205309],
  [ 0.450000, 0.314930],
  [ 0.550000, 0.395081],
  [ 0.650000, 0.431845],
  [ 0.750000, 0.550389],
  [ 0.850000, -0.199725],
  [ 0.950000, -0.268086],
  [ 1.050000, -0.322808],
  [ 1.150000, -0.477805],
  [ 1.250000, -0.777085],
  [ 1.350000, -0.892518],
  [ 1.450000, -2.186409],
]
gam500_layer2_phioffv3_35_e = [
  [ 1.450000, -0.922433],
  [ 1.550000, -0.420780],
  [ 1.650000, -0.443152],
  [ 1.750000, -0.363089],
  [ 1.850000, -0.411137],
  [ 1.950000, -0.464642],
  [ 2.050000, -0.479350],
  [ 2.150000, -0.515471],
  [ 2.250000, -0.612768],
  [ 2.350000, 0.123176],
  [ 2.450000, 0.149555],
]
gam1000_layer2_phioffv3_35_b = [
  [ 0.050000, 0.046154],
  [ 0.150000, 0.066578],
  [ 0.250000, 0.069368],
  [ 0.350000, 0.118821],
  [ 0.450000, 0.204769],
  [ 0.550000, 0.301424],
  [ 0.650000, 0.315833],
  [ 0.750000, 0.449931],
  [ 0.850000, -0.152840],
  [ 0.950000, -0.198380],
  [ 1.050000, -0.268467],
  [ 1.150000, -0.346111],
  [ 1.250000, -0.625919],
  [ 1.350000, -0.727701],
  [ 1.450000, -2.178711],
]
gam1000_layer2_phioffv3_35_e = [
  [ 1.450000, -0.850059],
  [ 1.550000, -0.346058],
  [ 1.650000, -0.336276],
  [ 1.750000, -0.296619],
  [ 1.850000, -0.355826],
  [ 1.950000, -0.379030],
  [ 2.050000, -0.386070],
  [ 2.150000, -0.412281],
  [ 2.250000, -0.510580],
  [ 2.350000, 0.045078],
  [ 2.450000, 0.103852],
]


gam_layer2_phioffv3_35_b = [
    #gam5_layer2_phioffv3_35_b,
    gam10_layer2_phioffv3_35_b,
    gam25_layer2_phioffv3_35_b,
    gam50_layer2_phioffv3_35_b,
    gam75_layer2_phioffv3_35_b,
    gam100_layer2_phioffv3_35_b,
    gam200_layer2_phioffv3_35_b,
    gam500_layer2_phioffv3_35_b,
    gam1000_layer2_phioffv3_35_b,
    ]

gam_layer2_phioffv3_35_e = [
    #gam5_layer2_phioffv3_35_e,
    #gam10_layer2_phioffv3_35_e,
    gam25_layer2_phioffv3_35_e,
    gam50_layer2_phioffv3_35_e,
    gam75_layer2_phioffv3_35_e,
    gam100_layer2_phioffv3_35_e,
    gam200_layer2_phioffv3_35_e,
    gam500_layer2_phioffv3_35_e,
    gam1000_layer2_phioffv3_35_e,
    ]


###############################################################################
# Tables for v3 phi offset correction, layer 2, 3x7 electron clusters
#

ele5_layer2_phioffv3_37_b = [
  [ 0.050000, -0.170208],
  [ 0.150000, 1.027826],
  [ 0.250000, -1.931793],
  [ 0.350000, 0.000000],
  [ 0.450000, 0.000000],
  [ 0.550000, 0.000000],
  [ 0.650000, 0.000000],
  [ 0.750000, 0.000000],
  [ 0.850000, 0.000000],
  [ 0.950000, 0.000000],
  [ 1.050000, 0.000000],
  [ 1.150000, 0.000000],
  [ 1.250000, 0.000000],
  [ 1.350000, 0.000000],
  [ 1.450000, 0.000000],
]
ele5_layer2_phioffv3_37_e = [
  [ 1.450000, 0.000000],
  [ 1.550000, 0.000000],
  [ 1.650000, 0.000000],
  [ 1.750000, 0.000000],
  [ 1.850000, 0.000000],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
ele10_layer2_phioffv3_37_b = [
  [ 0.050000, 0.834026],
  [ 0.150000, 0.915829],
  [ 0.250000, 1.091902],
  [ 0.350000, 1.286632],
  [ 0.450000, 1.213186],
  [ 0.550000, 1.374626],
  [ 0.650000, 1.524646],
  [ 0.750000, 1.936571],
  [ 0.850000, -0.635128],
  [ 0.950000, -1.108785],
  [ 1.050000, -1.731246],
  [ 1.150000, -1.356589],
  [ 1.250000, -1.468219],
  [ 1.350000, -2.227987],
  [ 1.450000, -1.909861],
]
ele10_layer2_phioffv3_37_e = [
  [ 1.450000, 11.200850],
  [ 1.550000, -0.827435],
  [ 1.650000, -0.464395],
  [ 1.750000, -1.262138],
  [ 1.850000, 3.411058],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
ele25_layer2_phioffv3_37_b = [
  [ 0.050000, 0.572796],
  [ 0.150000, 0.753532],
  [ 0.250000, 0.767360],
  [ 0.350000, 0.888986],
  [ 0.450000, 1.114726],
  [ 0.550000, 1.072618],
  [ 0.650000, 0.954848],
  [ 0.750000, 1.202277],
  [ 0.850000, -0.534948],
  [ 0.950000, -0.985184],
  [ 1.050000, -0.888945],
  [ 1.150000, -1.514956],
  [ 1.250000, -1.544567],
  [ 1.350000, -1.834144],
  [ 1.450000, -2.036043],
]
ele25_layer2_phioffv3_37_e = [
  [ 1.450000, 0.188043],
  [ 1.550000, -0.297231],
  [ 1.650000, -0.932895],
  [ 1.750000, -1.067767],
  [ 1.850000, -1.349181],
  [ 1.950000, -1.156858],
  [ 2.050000, -0.864190],
  [ 2.150000, -1.014933],
  [ 2.250000, -1.206817],
  [ 2.350000, 0.872549],
  [ 2.450000, 0.832863],
]
ele50_layer2_phioffv3_37_b = [
  [ 0.050000, 0.525280],
  [ 0.150000, 0.557570],
  [ 0.250000, 0.583176],
  [ 0.350000, 0.763752],
  [ 0.450000, 0.881074],
  [ 0.550000, 0.934966],
  [ 0.650000, 0.985265],
  [ 0.750000, 1.063454],
  [ 0.850000, -0.646905],
  [ 0.950000, -0.789510],
  [ 1.050000, -0.872871],
  [ 1.150000, -1.241331],
  [ 1.250000, -1.611425],
  [ 1.350000, -1.476744],
  [ 1.450000, -2.311123],
]
ele50_layer2_phioffv3_37_e = [
  [ 1.450000, -1.000015],
  [ 1.550000, -0.667989],
  [ 1.650000, -0.765707],
  [ 1.750000, -0.656535],
  [ 1.850000, -0.897165],
  [ 1.950000, -0.946917],
  [ 2.050000, -0.969224],
  [ 2.150000, -0.976967],
  [ 2.250000, -1.115974],
  [ 2.350000, 0.480126],
  [ 2.450000, 0.589446],
]
ele75_layer2_phioffv3_37_b = [
  [ 0.050000, 0.477176],
  [ 0.150000, 0.525748],
  [ 0.250000, 0.498470],
  [ 0.350000, 0.683579],
  [ 0.450000, 0.823697],
  [ 0.550000, 0.916319],
  [ 0.650000, 0.911615],
  [ 0.750000, 0.986299],
  [ 0.850000, -0.478459],
  [ 0.950000, -0.640830],
  [ 1.050000, -0.799459],
  [ 1.150000, -1.149556],
  [ 1.250000, -1.462848],
  [ 1.350000, -1.510996],
  [ 1.450000, -2.144971],
]
ele75_layer2_phioffv3_37_e = [
  [ 1.450000, -0.215895],
  [ 1.550000, -0.697221],
  [ 1.650000, -0.671967],
  [ 1.750000, -0.746892],
  [ 1.850000, -0.781349],
  [ 1.950000, -0.663548],
  [ 2.050000, -1.044960],
  [ 2.150000, -0.878381],
  [ 2.250000, -0.878921],
  [ 2.350000, 0.471886],
  [ 2.450000, 0.627122],
]
ele100_layer2_phioffv3_37_b = [
  [ 0.050000, 0.431598],
  [ 0.150000, 0.438541],
  [ 0.250000, 0.462236],
  [ 0.350000, 0.591371],
  [ 0.450000, 0.743157],
  [ 0.550000, 0.835977],
  [ 0.650000, 0.869333],
  [ 0.750000, 0.982949],
  [ 0.850000, -0.454383],
  [ 0.950000, -0.601896],
  [ 1.050000, -0.739467],
  [ 1.150000, -0.987775],
  [ 1.250000, -1.352410],
  [ 1.350000, -1.485634],
  [ 1.450000, -2.185270],
]
ele100_layer2_phioffv3_37_e = [
  [ 1.450000, -0.626528],
  [ 1.550000, -0.539917],
  [ 1.650000, -0.675952],
  [ 1.750000, -0.568136],
  [ 1.850000, -0.675003],
  [ 1.950000, -0.644419],
  [ 2.050000, -0.769627],
  [ 2.150000, -0.904268],
  [ 2.250000, -0.950720],
  [ 2.350000, 0.480799],
  [ 2.450000, 0.538865],
]
ele200_layer2_phioffv3_37_b = [
  [ 0.050000, 0.323907],
  [ 0.150000, 0.331222],
  [ 0.250000, 0.353954],
  [ 0.350000, 0.480119],
  [ 0.450000, 0.610714],
  [ 0.550000, 0.701826],
  [ 0.650000, 0.762386],
  [ 0.750000, 0.852932],
  [ 0.850000, -0.350460],
  [ 0.950000, -0.446839],
  [ 1.050000, -0.577191],
  [ 1.150000, -0.768933],
  [ 1.250000, -1.160446],
  [ 1.350000, -1.260206],
  [ 1.450000, -2.312700],
]
ele200_layer2_phioffv3_37_e = [
  [ 1.450000, -0.690551],
  [ 1.550000, -0.503106],
  [ 1.650000, -0.542734],
  [ 1.750000, -0.523999],
  [ 1.850000, -0.558645],
  [ 1.950000, -0.599230],
  [ 2.050000, -0.663111],
  [ 2.150000, -0.675863],
  [ 2.250000, -0.759857],
  [ 2.350000, 0.377314],
  [ 2.450000, 0.445700],
]
ele500_layer2_phioffv3_37_b = [
  [ 0.050000, 0.210307],
  [ 0.150000, 0.220962],
  [ 0.250000, 0.234478],
  [ 0.350000, 0.324993],
  [ 0.450000, 0.443780],
  [ 0.550000, 0.518419],
  [ 0.650000, 0.585200],
  [ 0.750000, 0.706543],
  [ 0.850000, -0.234681],
  [ 0.950000, -0.310601],
  [ 1.050000, -0.409599],
  [ 1.150000, -0.566826],
  [ 1.250000, -0.896793],
  [ 1.350000, -1.043555],
  [ 1.450000, -2.109026],
]
ele500_layer2_phioffv3_37_e = [
  [ 1.450000, -0.778429],
  [ 1.550000, -0.417264],
  [ 1.650000, -0.454912],
  [ 1.750000, -0.376924],
  [ 1.850000, -0.431673],
  [ 1.950000, -0.473217],
  [ 2.050000, -0.500986],
  [ 2.150000, -0.555830],
  [ 2.250000, -0.642301],
  [ 2.350000, 0.266200],
  [ 2.450000, 0.313156],
]
ele1000_layer2_phioffv3_37_b = [
  [ 0.050000, 0.133356],
  [ 0.150000, 0.135916],
  [ 0.250000, 0.154505],
  [ 0.350000, 0.221423],
  [ 0.450000, 0.329144],
  [ 0.550000, 0.414927],
  [ 0.650000, 0.470358],
  [ 0.750000, 0.579500],
  [ 0.850000, -0.167737],
  [ 0.950000, -0.225692],
  [ 1.050000, -0.309116],
  [ 1.150000, -0.435546],
  [ 1.250000, -0.722262],
  [ 1.350000, -0.881447],
  [ 1.450000, -2.266379],
]
ele1000_layer2_phioffv3_37_e = [
  [ 1.450000, -0.724826],
  [ 1.550000, -0.356266],
  [ 1.650000, -0.365087],
  [ 1.750000, -0.314152],
  [ 1.850000, -0.366102],
  [ 1.950000, -0.382190],
  [ 2.050000, -0.401434],
  [ 2.150000, -0.448853],
  [ 2.250000, -0.534864],
  [ 2.350000, 0.179711],
  [ 2.450000, 0.226092],
]


ele_layer2_phioffv3_37_b = [
    #ele5_layer2_phioffv3_37_b,
    ele10_layer2_phioffv3_37_b,
    ele25_layer2_phioffv3_37_b,
    ele50_layer2_phioffv3_37_b,
    ele75_layer2_phioffv3_37_b,
    ele100_layer2_phioffv3_37_b,
    ele200_layer2_phioffv3_37_b,
    ele500_layer2_phioffv3_37_b,
    ele1000_layer2_phioffv3_37_b,
    ]

ele_layer2_phioffv3_37_e = [
    #ele5_layer2_phioffv3_37_e,
    #ele10_layer2_phioffv3_37_e,
    ele25_layer2_phioffv3_37_e,
    ele50_layer2_phioffv3_37_e,
    ele75_layer2_phioffv3_37_e,
    ele100_layer2_phioffv3_37_e,
    ele200_layer2_phioffv3_37_e,
    ele500_layer2_phioffv3_37_e,
    ele1000_layer2_phioffv3_37_e,
    ]


###############################################################################
# Tables for v3 phi offset correction, layer 2, 3x7 photon clusters
#

gam5_layer2_phioffv3_37_b = [
  [ 0.050000, 0.158152],
  [ 0.150000, 1.062571],
  [ 0.250000, 1.170857],
  [ 0.350000, 0.649374],
  [ 0.450000, 1.618886],
  [ 0.550000, 1.326756],
  [ 0.650000, 0.436852],
  [ 0.750000, 1.365205],
  [ 0.850000, -1.141747],
  [ 0.950000, -1.133394],
  [ 1.050000, -1.153896],
  [ 1.150000, -1.737920],
  [ 1.250000, -6.430581],
  [ 1.350000, 0.000000],
  [ 1.450000, 0.000000],
]
gam5_layer2_phioffv3_37_e = [
  [ 1.450000, 0.000000],
  [ 1.550000, 0.000000],
  [ 1.650000, 0.000000],
  [ 1.750000, 0.000000],
  [ 1.850000, 0.000000],
  [ 1.950000, 0.000000],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
gam10_layer2_phioffv3_37_b = [
  [ 0.050000, 0.479067],
  [ 0.150000, 1.041051],
  [ 0.250000, 0.530710],
  [ 0.350000, 0.973701],
  [ 0.450000, 0.820858],
  [ 0.550000, 1.583836],
  [ 0.650000, 0.729232],
  [ 0.750000, 1.259145],
  [ 0.850000, -0.432516],
  [ 0.950000, -1.303816],
  [ 1.050000, -0.738147],
  [ 1.150000, -1.423480],
  [ 1.250000, -2.021019],
  [ 1.350000, -0.308307],
  [ 1.450000, -1.566865],
]
gam10_layer2_phioffv3_37_e = [
  [ 1.450000, 4.259815],
  [ 1.550000, -1.647185],
  [ 1.650000, -1.182535],
  [ 1.750000, -0.607936],
  [ 1.850000, -0.407078],
  [ 1.950000, -0.331372],
  [ 2.050000, 0.000000],
  [ 2.150000, 0.000000],
  [ 2.250000, 0.000000],
  [ 2.350000, 0.000000],
  [ 2.450000, 0.000000],
]
gam25_layer2_phioffv3_37_b = [
  [ 0.050000, 0.621524],
  [ 0.150000, 0.464757],
  [ 0.250000, 0.738873],
  [ 0.350000, 0.915367],
  [ 0.450000, 0.919470],
  [ 0.550000, 0.782877],
  [ 0.650000, 0.843218],
  [ 0.750000, 1.010707],
  [ 0.850000, -0.626048],
  [ 0.950000, -0.834875],
  [ 1.050000, -1.330115],
  [ 1.150000, -1.538451],
  [ 1.250000, -1.789211],
  [ 1.350000, -1.632277],
  [ 1.450000, -2.259162],
]
gam25_layer2_phioffv3_37_e = [
  [ 1.450000, -0.637523],
  [ 1.550000, -0.543543],
  [ 1.650000, -0.879003],
  [ 1.750000, -0.740630],
  [ 1.850000, -1.722429],
  [ 1.950000, -0.760551],
  [ 2.050000, -0.967210],
  [ 2.150000, -1.116060],
  [ 2.250000, -1.170451],
  [ 2.350000, 0.662228],
  [ 2.450000, 0.477555],
]
gam50_layer2_phioffv3_37_b = [
  [ 0.050000, 0.437115],
  [ 0.150000, 0.413345],
  [ 0.250000, 0.460046],
  [ 0.350000, 0.587612],
  [ 0.450000, 0.786087],
  [ 0.550000, 0.819338],
  [ 0.650000, 0.890348],
  [ 0.750000, 0.976245],
  [ 0.850000, -0.441234],
  [ 0.950000, -0.600357],
  [ 1.050000, -0.768840],
  [ 1.150000, -1.046840],
  [ 1.250000, -1.443900],
  [ 1.350000, -1.377220],
  [ 1.450000, -2.143931],
]
gam50_layer2_phioffv3_37_e = [
  [ 1.450000, -0.615910],
  [ 1.550000, -0.562865],
  [ 1.650000, -0.706763],
  [ 1.750000, -0.781972],
  [ 1.850000, -0.755842],
  [ 1.950000, -0.890217],
  [ 2.050000, -0.822013],
  [ 2.150000, -0.939693],
  [ 2.250000, -0.948799],
  [ 2.350000, 0.536310],
  [ 2.450000, 0.576932],
]
gam75_layer2_phioffv3_37_b = [
  [ 0.050000, 0.384620],
  [ 0.150000, 0.390341],
  [ 0.250000, 0.452532],
  [ 0.350000, 0.521112],
  [ 0.450000, 0.635782],
  [ 0.550000, 0.776655],
  [ 0.650000, 0.821897],
  [ 0.750000, 0.941373],
  [ 0.850000, -0.350001],
  [ 0.950000, -0.509567],
  [ 1.050000, -0.666732],
  [ 1.150000, -0.820974],
  [ 1.250000, -1.291412],
  [ 1.350000, -1.392582],
  [ 1.450000, -2.652848],
]
gam75_layer2_phioffv3_37_e = [
  [ 1.450000, -0.933488],
  [ 1.550000, -0.525224],
  [ 1.650000, -0.663423],
  [ 1.750000, -0.491812],
  [ 1.850000, -0.638856],
  [ 1.950000, -0.686238],
  [ 2.050000, -0.735288],
  [ 2.150000, -0.864405],
  [ 2.250000, -0.917470],
  [ 2.350000, 0.419065],
  [ 2.450000, 0.395743],
]
gam100_layer2_phioffv3_37_b = [
  [ 0.050000, 0.324965],
  [ 0.150000, 0.349921],
  [ 0.250000, 0.361044],
  [ 0.350000, 0.471576],
  [ 0.450000, 0.609046],
  [ 0.550000, 0.677219],
  [ 0.650000, 0.759973],
  [ 0.750000, 0.849583],
  [ 0.850000, -0.360565],
  [ 0.950000, -0.453158],
  [ 1.050000, -0.572447],
  [ 1.150000, -0.790905],
  [ 1.250000, -1.176058],
  [ 1.350000, -1.331107],
  [ 1.450000, -2.212043],
]
gam100_layer2_phioffv3_37_e = [
  [ 1.450000, -0.940777],
  [ 1.550000, -0.537014],
  [ 1.650000, -0.574081],
  [ 1.750000, -0.552314],
  [ 1.850000, -0.592279],
  [ 1.950000, -0.628823],
  [ 2.050000, -0.672811],
  [ 2.150000, -0.754272],
  [ 2.250000, -0.820190],
  [ 2.350000, 0.378474],
  [ 2.450000, 0.451836],
]
gam200_layer2_phioffv3_37_b = [
  [ 0.050000, 0.241109],
  [ 0.150000, 0.248143],
  [ 0.250000, 0.267384],
  [ 0.350000, 0.359276],
  [ 0.450000, 0.489143],
  [ 0.550000, 0.564889],
  [ 0.650000, 0.620947],
  [ 0.750000, 0.745514],
  [ 0.850000, -0.261821],
  [ 0.950000, -0.345715],
  [ 1.050000, -0.444956],
  [ 1.150000, -0.622833],
  [ 1.250000, -0.970181],
  [ 1.350000, -1.112520],
  [ 1.450000, -2.235152],
]
gam200_layer2_phioffv3_37_e = [
  [ 1.450000, -0.746076],
  [ 1.550000, -0.418756],
  [ 1.650000, -0.479624],
  [ 1.750000, -0.404299],
  [ 1.850000, -0.457705],
  [ 1.950000, -0.496771],
  [ 2.050000, -0.529259],
  [ 2.150000, -0.609744],
  [ 2.250000, -0.680489],
  [ 2.350000, 0.285252],
  [ 2.450000, 0.333844],
]
gam500_layer2_phioffv3_37_b = [
  [ 0.050000, 0.137003],
  [ 0.150000, 0.142852],
  [ 0.250000, 0.148639],
  [ 0.350000, 0.230985],
  [ 0.450000, 0.340350],
  [ 0.550000, 0.425529],
  [ 0.650000, 0.463098],
  [ 0.750000, 0.581871],
  [ 0.850000, -0.161619],
  [ 0.950000, -0.228954],
  [ 1.050000, -0.287894],
  [ 1.150000, -0.433266],
  [ 1.250000, -0.736723],
  [ 1.350000, -0.855075],
  [ 1.450000, -2.061113],
]
gam500_layer2_phioffv3_37_e = [
  [ 1.450000, -0.818157],
  [ 1.550000, -0.359212],
  [ 1.650000, -0.386500],
  [ 1.750000, -0.311205],
  [ 1.850000, -0.353034],
  [ 1.950000, -0.397724],
  [ 2.050000, -0.408750],
  [ 2.150000, -0.445446],
  [ 2.250000, -0.537549],
  [ 2.350000, 0.185137],
  [ 2.450000, 0.218554],
]
gam1000_layer2_phioffv3_37_b = [
  [ 0.050000, 0.068304],
  [ 0.150000, 0.085713],
  [ 0.250000, 0.092139],
  [ 0.350000, 0.142253],
  [ 0.450000, 0.232165],
  [ 0.550000, 0.330340],
  [ 0.650000, 0.349645],
  [ 0.750000, 0.475624],
  [ 0.850000, -0.114461],
  [ 0.950000, -0.159503],
  [ 1.050000, -0.233485],
  [ 1.150000, -0.304576],
  [ 1.250000, -0.587421],
  [ 1.350000, -0.693066],
  [ 1.450000, -2.037628],
]
gam1000_layer2_phioffv3_37_e = [
  [ 1.450000, -0.745289],
  [ 1.550000, -0.295787],
  [ 1.650000, -0.291608],
  [ 1.750000, -0.248493],
  [ 1.850000, -0.304154],
  [ 1.950000, -0.319233],
  [ 2.050000, -0.321887],
  [ 2.150000, -0.347556],
  [ 2.250000, -0.444159],
  [ 2.350000, 0.106254],
  [ 2.450000, 0.165833],
]



gam_layer2_phioffv3_37_b = [
    #gam5_layer2_phioffv3_37_b,
    gam10_layer2_phioffv3_37_b,
    gam25_layer2_phioffv3_37_b,
    gam50_layer2_phioffv3_37_b,
    gam75_layer2_phioffv3_37_b,
    gam100_layer2_phioffv3_37_b,
    gam200_layer2_phioffv3_37_b,
    gam500_layer2_phioffv3_37_b,
    gam1000_layer2_phioffv3_37_b,
    ]

gam_layer2_phioffv3_37_e = [
    #gam5_layer2_phioffv3_37_e,
    #gam10_layer2_phioffv3_37_e,
    gam25_layer2_phioffv3_37_e,
    gam50_layer2_phioffv3_37_e,
    gam75_layer2_phioffv3_37_e,
    gam100_layer2_phioffv3_37_e,
    gam200_layer2_phioffv3_37_e,
    gam500_layer2_phioffv3_37_e,
    gam1000_layer2_phioffv3_37_e,
    ]


###############################################################################


#
# Don't use the 5 GeV samples for now --- it's not fully populated
# across eta.  Similarly, don't use the 10 GeV samples in the endcap.
#
#ele_phioffv3_energies = [
#    5*GeV, 10*GeV, 25*GeV, 50*GeV, 75*GeV, 100*GeV, 200*GeV, 500*GeV, 1000*GeV
#    ]
#gam_phioffv3_energies = [
#    5*GeV, 10*GeV, 25*GeV, 50*GeV, 75*GeV, 100*GeV, 200*GeV, 500*GeV, 1000*GeV
#    ]
ele_phioffv3_energies_b = [
    10*GeV, 25*GeV, 50*GeV, 75*GeV, 100*GeV, 200*GeV, 500*GeV, 1000*GeV
    ]
gam_phioffv3_energies_b = [
    10*GeV, 25*GeV, 50*GeV, 75*GeV, 100*GeV, 200*GeV, 500*GeV, 1000*GeV
    ]
ele_phioffv3_energies_e = [
    25*GeV, 50*GeV, 75*GeV, 100*GeV, 200*GeV, 500*GeV, 1000*GeV
    ]
gam_phioffv3_energies_e = [
    25*GeV, 50*GeV, 75*GeV, 100*GeV, 200*GeV, 500*GeV, 1000*GeV
    ]


phioffv3_energies_b = {'ele55' : ele_phioffv3_energies_b,
                       'ele35' : ele_phioffv3_energies_b,
                       'ele37' : ele_phioffv3_energies_b,
                       'gam55' : gam_phioffv3_energies_b,
                       'gam35' : gam_phioffv3_energies_b,
                       'gam37' : gam_phioffv3_energies_b,
                     
                       # Use 5x5 for other cluster sizes.
                       'ele33' : ele_phioffv3_energies_b,
                       'ele57' : ele_phioffv3_energies_b,
                       'ele77' : ele_phioffv3_energies_b,
                       'gam33' : gam_phioffv3_energies_b,
                       'gam57' : gam_phioffv3_energies_b,
                       'gam77' : gam_phioffv3_energies_b,
                       }


phioffv3_energies_e = {'ele55' : ele_phioffv3_energies_e,
                       'ele35' : ele_phioffv3_energies_e,
                       'ele37' : ele_phioffv3_energies_e,
                       'gam55' : gam_phioffv3_energies_e,
                       'gam35' : gam_phioffv3_energies_e,
                       'gam37' : gam_phioffv3_energies_e,
                     
                       # Use 5x5 for other cluster sizes.
                       'ele33' : ele_phioffv3_energies_e,
                       'ele57' : ele_phioffv3_energies_e,
                       'ele77' : ele_phioffv3_energies_e,
                       'gam33' : gam_phioffv3_energies_e,
                       'gam57' : gam_phioffv3_energies_e,
                       'gam77' : gam_phioffv3_energies_e,
                       }


class CaloSwPhioff_v3_b2_parms:
    region = CALOCORR_EMB2
    correction_coef = 0.001
    interp_barriers = [0.8]
    degree = 3
    flip_phi = 1
    energy_degree = 2

    energies = phioffv3_energies_b

    correction = {'ele55' : ele_layer2_phioffv3_55_b,
                  'ele35' : ele_layer2_phioffv3_35_b,
                  'ele37' : ele_layer2_phioffv3_37_b,
                  'gam55' : gam_layer2_phioffv3_55_b,
                  'gam35' : gam_layer2_phioffv3_35_b,
                  'gam37' : gam_layer2_phioffv3_37_b,

                  # Use 5x5 for other cluster sizes.
                  'ele33' : ele_layer2_phioffv3_55_b,
                  'ele57' : ele_layer2_phioffv3_55_b,
                  'ele77' : ele_layer2_phioffv3_55_b,
                  'gam33' : gam_layer2_phioffv3_55_b,
                  'gam57' : gam_layer2_phioffv3_55_b,
                  'gam77' : gam_layer2_phioffv3_55_b,
                  }


class CaloSwPhioff_v3_e2_parms:
    region = CALOCORR_EME2
    correction_coef = 0.001
    interp_barriers = [2.3]
    degree = 3
    flip_phi = 1
    energy_degree = 2

    energies = phioffv3_energies_e

    correction = {'ele55' : ele_layer2_phioffv3_55_e,
                  'ele35' : ele_layer2_phioffv3_35_e,
                  'ele37' : ele_layer2_phioffv3_37_e,
                  'gam55' : gam_layer2_phioffv3_55_e,
                  'gam35' : gam_layer2_phioffv3_35_e,
                  'gam37' : gam_layer2_phioffv3_37_e,

                  # Use 5x5 for other cluster sizes.
                  'ele33' : ele_layer2_phioffv3_55_e,
                  'ele57' : ele_layer2_phioffv3_55_e,
                  'ele77' : ele_layer2_phioffv3_55_e,
                  'gam33' : gam_layer2_phioffv3_55_e,
                  'gam57' : gam_layer2_phioffv3_55_e,
                  'gam77' : gam_layer2_phioffv3_55_e,
                  }



CaloSwPhioff_v3_parms = { EMB2 : CaloSwPhioff_v3_b2_parms,
                          EME2 : CaloSwPhioff_v3_e2_parms,
                          }


